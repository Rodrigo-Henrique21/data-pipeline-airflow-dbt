[0m06:18:02.220551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77aa030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb779fd38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb778cd77c0>]}


============================== 06:18:02.227502 | da21a240-cb31-4150-9957-d44882cef64d ==============================
[0m06:18:02.227502 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:18:02.228951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:18:02.236657 [info ] [MainThread]: dbt version: 1.8.0
[0m06:18:02.237675 [info ] [MainThread]: python version: 3.9.14
[0m06:18:02.238783 [info ] [MainThread]: python path: /usr/local/bin/python
[0m06:18:02.239963 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m06:18:02.292529 [info ] [MainThread]: Using profiles dir at /usr/local/*****/dbt
[0m06:18:02.294016 [info ] [MainThread]: Using profiles.yml file at /usr/local/*****/dbt/profiles.yml
[0m06:18:02.295216 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/*****/dbt/dbt_project.yml
[0m06:18:02.296445 [info ] [MainThread]: adapter type: postgres
[0m06:18:02.297394 [info ] [MainThread]: adapter version: 1.8.2
[0m06:18:02.305364 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:18:02.306499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da21a240-cb31-4150-9957-d44882cef64d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77825c610>]}
[0m06:18:02.307459 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:18:02.308335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da21a240-cb31-4150-9957-d44882cef64d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77825c1c0>]}
[0m06:18:02.384112 [info ] [MainThread]: Configuration:
[0m06:18:02.385281 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:18:02.386318 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:18:02.387225 [info ] [MainThread]: Required dependencies:
[0m06:18:02.388087 [debug] [MainThread]: Executing "git --help"
[0m06:18:02.391648 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:18:02.392672 [debug] [MainThread]: STDERR: "b''"
[0m06:18:02.393413 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:18:02.394360 [info ] [MainThread]: Connection:
[0m06:18:02.395746 [info ] [MainThread]:   host: postgres
[0m06:18:02.397068 [info ] [MainThread]:   port: 5432
[0m06:18:02.398267 [info ] [MainThread]:   user: *****
[0m06:18:02.399490 [info ] [MainThread]:   database: *****
[0m06:18:02.401166 [info ] [MainThread]:   schema: public
[0m06:18:02.402304 [info ] [MainThread]:   connect_timeout: 10
[0m06:18:02.403216 [info ] [MainThread]:   role: None
[0m06:18:02.404115 [info ] [MainThread]:   search_path: None
[0m06:18:02.405068 [info ] [MainThread]:   keepalives_idle: 0
[0m06:18:02.406006 [info ] [MainThread]:   sslmode: None
[0m06:18:02.406895 [info ] [MainThread]:   sslcert: None
[0m06:18:02.407744 [info ] [MainThread]:   sslkey: None
[0m06:18:02.408576 [info ] [MainThread]:   sslrootcert: None
[0m06:18:02.409482 [info ] [MainThread]:   application_name: dbt
[0m06:18:02.410459 [info ] [MainThread]:   retries: 1
[0m06:18:02.411833 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:18:02.466366 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m06:18:02.488084 [debug] [MainThread]: Using postgres connection "debug"
[0m06:18:02.489210 [debug] [MainThread]: On debug: select 1 as id
[0m06:18:02.490053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:18:02.493156 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
FATAL:  password authentication failed for user "*****"

[0m06:18:02.495651 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m06:18:02.496538 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m06:18:02.497323 [debug] [MainThread]: On debug: No close available on handle
[0m06:18:02.498056 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m06:18:02.498931 [info ] [MainThread]: [31m1 check failed:[0m
[0m06:18:02.499879 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  FATAL:  password authentication failed for user "*****"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m06:18:02.501313 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.33620417, "process_user_time": 1.32728, "process_kernel_time": 0.030629, "process_mem_max_rss": "95028", "process_in_blocks": "1984", "command_success": false, "process_out_blocks": "0"}
[0m06:18:02.502308 [debug] [MainThread]: Command `dbt debug` failed at 06:18:02.502199 after 0.34 seconds
[0m06:18:02.503097 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:18:02.503875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77aa030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77825c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb778d35580>]}
[0m06:18:02.504678 [debug] [MainThread]: Flushing usage events
[0m06:34:57.488987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e6cde0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e62adbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e4fb17c0>]}


============================== 06:34:57.495270 | 21fcf0d4-57b5-4dd4-905a-8acc8c30bfb6 ==============================
[0m06:34:57.495270 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:34:57.496755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:34:57.508383 [info ] [MainThread]: dbt version: 1.8.0
[0m06:34:57.509296 [info ] [MainThread]: python version: 3.9.14
[0m06:34:57.510347 [info ] [MainThread]: python path: /usr/local/bin/python
[0m06:34:57.511635 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m06:34:57.575212 [info ] [MainThread]: Using profiles dir at /usr/local/*****/dbt
[0m06:34:57.576658 [info ] [MainThread]: Using profiles.yml file at /usr/local/*****/dbt/profiles.yml
[0m06:34:57.577822 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/*****/dbt/dbt_project.yml
[0m06:34:57.579076 [info ] [MainThread]: adapter type: postgres
[0m06:34:57.579975 [info ] [MainThread]: adapter version: 1.8.2
[0m06:34:57.587350 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:34:57.588275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21fcf0d4-57b5-4dd4-905a-8acc8c30bfb6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e454b640>]}
[0m06:34:57.589390 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:34:57.590462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21fcf0d4-57b5-4dd4-905a-8acc8c30bfb6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e454b7c0>]}
[0m06:34:57.668020 [info ] [MainThread]: Configuration:
[0m06:34:57.669426 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:34:57.670566 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:34:57.671586 [info ] [MainThread]: Required dependencies:
[0m06:34:57.672529 [debug] [MainThread]: Executing "git --help"
[0m06:34:57.685413 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:34:57.686889 [debug] [MainThread]: STDERR: "b''"
[0m06:34:57.688200 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:34:57.689299 [info ] [MainThread]: Connection:
[0m06:34:57.690580 [info ] [MainThread]:   host: postgres
[0m06:34:57.691487 [info ] [MainThread]:   port: 5432
[0m06:34:57.692295 [info ] [MainThread]:   user: *****
[0m06:34:57.693380 [info ] [MainThread]:   database: *****
[0m06:34:57.694416 [info ] [MainThread]:   schema: public
[0m06:34:57.695445 [info ] [MainThread]:   connect_timeout: 10
[0m06:34:57.696748 [info ] [MainThread]:   role: None
[0m06:34:57.697820 [info ] [MainThread]:   search_path: None
[0m06:34:57.698862 [info ] [MainThread]:   keepalives_idle: 0
[0m06:34:57.699843 [info ] [MainThread]:   sslmode: None
[0m06:34:57.700850 [info ] [MainThread]:   sslcert: None
[0m06:34:57.701864 [info ] [MainThread]:   sslkey: None
[0m06:34:57.702878 [info ] [MainThread]:   sslrootcert: None
[0m06:34:57.703802 [info ] [MainThread]:   application_name: dbt
[0m06:34:57.704723 [info ] [MainThread]:   retries: 1
[0m06:34:57.706201 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:34:57.772112 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m06:34:57.791729 [debug] [MainThread]: Using postgres connection "debug"
[0m06:34:57.792740 [debug] [MainThread]: On debug: select 1 as id
[0m06:34:57.793802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:57.798435 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m06:34:57.799942 [debug] [MainThread]: On debug: Close
[0m06:34:57.800761 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:34:57.801685 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:34:57.803343 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.36856645, "process_user_time": 1.367184, "process_kernel_time": 0.096887, "process_mem_max_rss": "94996", "process_in_blocks": "44176", "process_out_blocks": "0"}
[0m06:34:57.804406 [debug] [MainThread]: Command `dbt debug` succeeded at 06:34:57.804301 after 0.37 seconds
[0m06:34:57.805170 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:34:57.805940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e6cde0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e62adbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86e569ae50>]}
[0m06:34:57.806705 [debug] [MainThread]: Flushing usage events
[0m06:36:38.160714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b2001040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b02ad370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b02ad310>]}


============================== 06:36:38.166674 | 02ce6a6b-8927-4e58-8a6b-4b0630e93d0f ==============================
[0m06:36:38.166674 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:36:38.167946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/*****/dbt', 'log_path': '/usr/local/*****/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:36:38.233728 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:36:38.235088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af9088e0>]}
[0m06:36:38.236055 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m06:36:38.237136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af9088b0>]}
[0m06:36:38.411349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b0291e80>]}
[0m06:36:38.457682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b0f26c70>]}
[0m06:36:38.459486 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:36:38.529601 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:36:38.531899 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:36:38.533048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af8ac310>]}
[0m06:36:39.677653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17adadb130>]}
[0m06:36:39.800025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17adaa77c0>]}
[0m06:36:39.801227 [info ] [MainThread]: Found 3 models, 1 source, 428 macros
[0m06:36:39.802854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ce6a6b-8927-4e58-8a6b-4b0630e93d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ada75520>]}
[0m06:36:39.805093 [info ] [MainThread]: 
[0m06:36:39.806304 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:36:39.807781 [debug] [MainThread]: Command end result
[0m06:36:39.845664 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7393398, "process_user_time": 2.584871, "process_kernel_time": 0.071342, "process_mem_max_rss": "103636", "process_in_blocks": "59528", "process_out_blocks": "0"}
[0m06:36:39.846999 [debug] [MainThread]: Command `dbt test` succeeded at 06:36:39.846819 after 1.74 seconds
[0m06:36:39.848017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b2001040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b09beac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ada754c0>]}
[0m06:36:39.848919 [debug] [MainThread]: Flushing usage events
[0m10:37:08.016618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef552d1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5357a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5357a400>]}


============================== 10:37:08.022454 | 9ba1e475-7b93-4464-94d8-498032858a21 ==============================
[0m10:37:08.022454 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:37:08.023740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:37:08.034616 [info ] [MainThread]: dbt version: 1.8.0
[0m10:37:08.035996 [info ] [MainThread]: python version: 3.9.14
[0m10:37:08.037033 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:37:08.038452 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:37:08.101463 [info ] [MainThread]: Using profiles dir at /usr/local/*****/dbt
[0m10:37:08.102991 [info ] [MainThread]: Using profiles.yml file at /usr/local/*****/dbt/profiles.yml
[0m10:37:08.104047 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/*****/dbt/dbt_project.yml
[0m10:37:08.105329 [info ] [MainThread]: adapter type: postgres
[0m10:37:08.106332 [info ] [MainThread]: adapter version: 1.8.2
[0m10:37:08.189185 [info ] [MainThread]: Configuration:
[0m10:37:08.190216 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:37:08.191122 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:37:08.191965 [info ] [MainThread]: Required dependencies:
[0m10:37:08.192879 [debug] [MainThread]: Executing "git --help"
[0m10:37:08.195832 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:37:08.196778 [debug] [MainThread]: STDERR: "b''"
[0m10:37:08.197580 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:37:08.198449 [info ] [MainThread]: Connection:
[0m10:37:08.199585 [info ] [MainThread]:   host: postgres
[0m10:37:08.200583 [info ] [MainThread]:   port: 5432
[0m10:37:08.201453 [info ] [MainThread]:   user: *****
[0m10:37:08.202340 [info ] [MainThread]:   database: *****
[0m10:37:08.203200 [info ] [MainThread]:   schema: public
[0m10:37:08.204000 [info ] [MainThread]:   connect_timeout: 10
[0m10:37:08.205145 [info ] [MainThread]:   role: None
[0m10:37:08.206080 [info ] [MainThread]:   search_path: None
[0m10:37:08.206981 [info ] [MainThread]:   keepalives_idle: 0
[0m10:37:08.208105 [info ] [MainThread]:   sslmode: None
[0m10:37:08.209212 [info ] [MainThread]:   sslcert: None
[0m10:37:08.210389 [info ] [MainThread]:   sslkey: None
[0m10:37:08.211417 [info ] [MainThread]:   sslrootcert: None
[0m10:37:08.212425 [info ] [MainThread]:   application_name: dbt
[0m10:37:08.213295 [info ] [MainThread]:   retries: 1
[0m10:37:08.214321 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:37:08.270403 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:37:08.289615 [debug] [MainThread]: Using postgres connection "debug"
[0m10:37:08.290652 [debug] [MainThread]: On debug: select 1 as id
[0m10:37:08.291418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:08.293868 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
FATAL:  password authentication failed for user "*****"

[0m10:37:08.296318 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:37:08.297085 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:37:08.297892 [debug] [MainThread]: On debug: No close available on handle
[0m10:37:08.298657 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:37:08.299534 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:37:08.300324 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  FATAL:  password authentication failed for user "*****"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:37:08.301593 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.3529015, "process_user_time": 1.366164, "process_kernel_time": 0.092447, "process_mem_max_rss": "94884", "process_in_blocks": "23608", "command_success": false, "process_out_blocks": "0"}
[0m10:37:08.302659 [debug] [MainThread]: Command `dbt debug` failed at 10:37:08.302495 after 0.35 seconds
[0m10:37:08.303482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:37:08.304247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef552d1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef53489f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef541ec520>]}
[0m10:37:08.304988 [debug] [MainThread]: Flushing usage events
[0m10:46:21.497372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf750dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf57c0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf57c02b0>]}


============================== 10:46:21.503366 | e848204b-dc74-4977-84d8-80fcf135e0cc ==============================
[0m10:46:21.503366 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:46:21.504629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:46:21.519400 [info ] [MainThread]: dbt version: 1.8.0
[0m10:46:21.520440 [info ] [MainThread]: python version: 3.9.14
[0m10:46:21.521421 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:46:21.522728 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:46:21.586160 [info ] [MainThread]: Using profiles dir at /usr/local/*****/dbt
[0m10:46:21.587322 [info ] [MainThread]: Using profiles.yml file at /usr/local/*****/dbt/profiles.yml
[0m10:46:21.588339 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/*****/dbt/dbt_project.yml
[0m10:46:21.589714 [info ] [MainThread]: adapter type: postgres
[0m10:46:21.590659 [info ] [MainThread]: adapter version: 1.8.2
[0m10:46:21.670376 [info ] [MainThread]: Configuration:
[0m10:46:21.671552 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:46:21.672446 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:46:21.673245 [info ] [MainThread]: Required dependencies:
[0m10:46:21.674216 [debug] [MainThread]: Executing "git --help"
[0m10:46:21.684043 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:46:21.685199 [debug] [MainThread]: STDERR: "b''"
[0m10:46:21.686019 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:46:21.686948 [info ] [MainThread]: Connection:
[0m10:46:21.687983 [info ] [MainThread]:   host: postgres
[0m10:46:21.689033 [info ] [MainThread]:   port: 5432
[0m10:46:21.690092 [info ] [MainThread]:   user: *****
[0m10:46:21.691129 [info ] [MainThread]:   database: *****
[0m10:46:21.692091 [info ] [MainThread]:   schema: public
[0m10:46:21.692921 [info ] [MainThread]:   connect_timeout: 10
[0m10:46:21.693717 [info ] [MainThread]:   role: None
[0m10:46:21.694501 [info ] [MainThread]:   search_path: None
[0m10:46:21.695311 [info ] [MainThread]:   keepalives_idle: 0
[0m10:46:21.696056 [info ] [MainThread]:   sslmode: None
[0m10:46:21.696810 [info ] [MainThread]:   sslcert: None
[0m10:46:21.697570 [info ] [MainThread]:   sslkey: None
[0m10:46:21.698505 [info ] [MainThread]:   sslrootcert: None
[0m10:46:21.699387 [info ] [MainThread]:   application_name: dbt
[0m10:46:21.700470 [info ] [MainThread]:   retries: 1
[0m10:46:21.701633 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:46:21.757530 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:46:21.776635 [debug] [MainThread]: Using postgres connection "debug"
[0m10:46:21.777533 [debug] [MainThread]: On debug: select 1 as id
[0m10:46:21.778240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:46:21.782729 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m10:46:21.783947 [debug] [MainThread]: On debug: Close
[0m10:46:21.784718 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:46:21.785609 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:46:21.787073 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.34382015, "process_user_time": 1.333684, "process_kernel_time": 0.091627, "process_mem_max_rss": "94868", "process_in_blocks": "44456", "process_out_blocks": "0"}
[0m10:46:21.787992 [debug] [MainThread]: Command `dbt debug` succeeded at 10:46:21.787890 after 0.34 seconds
[0m10:46:21.788683 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:46:21.789480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf750dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf64dc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf6ae6eb0>]}
[0m10:46:21.790262 [debug] [MainThread]: Flushing usage events
[0m18:46:49.903682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f50e9cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f4f14f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f4f14f2b0>]}


============================== 18:46:49.908963 | ed89a521-3bea-4c4b-95af-447b3e17aced ==============================
[0m18:46:49.908963 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:46:49.910140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:46:49.917831 [info ] [MainThread]: dbt version: 1.8.0
[0m18:46:49.918872 [info ] [MainThread]: python version: 3.9.14
[0m18:46:49.919812 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:46:49.920831 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:46:49.978833 [info ] [MainThread]: Using profiles dir at /usr/local/*****/dbt
[0m18:46:49.980165 [info ] [MainThread]: Using profiles.yml file at /usr/local/*****/dbt/profiles.yml
[0m18:46:49.981227 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/*****/dbt/dbt_project.yml
[0m18:46:49.982524 [info ] [MainThread]: adapter type: postgres
[0m18:46:49.983528 [info ] [MainThread]: adapter version: 1.8.2
[0m18:46:50.067701 [info ] [MainThread]: Configuration:
[0m18:46:50.068946 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:46:50.070184 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:46:50.071069 [info ] [MainThread]: Required dependencies:
[0m18:46:50.071912 [debug] [MainThread]: Executing "git --help"
[0m18:46:50.074962 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:46:50.075952 [debug] [MainThread]: STDERR: "b''"
[0m18:46:50.076709 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:46:50.077555 [info ] [MainThread]: Connection:
[0m18:46:50.078651 [info ] [MainThread]:   host: postgres
[0m18:46:50.080194 [info ] [MainThread]:   port: 5432
[0m18:46:50.081652 [info ] [MainThread]:   user: *****
[0m18:46:50.083057 [info ] [MainThread]:   database: *****
[0m18:46:50.084228 [info ] [MainThread]:   schema: public
[0m18:46:50.085430 [info ] [MainThread]:   connect_timeout: 10
[0m18:46:50.086850 [info ] [MainThread]:   role: None
[0m18:46:50.088061 [info ] [MainThread]:   search_path: None
[0m18:46:50.089148 [info ] [MainThread]:   keepalives_idle: 0
[0m18:46:50.090185 [info ] [MainThread]:   sslmode: None
[0m18:46:50.091212 [info ] [MainThread]:   sslcert: None
[0m18:46:50.092242 [info ] [MainThread]:   sslkey: None
[0m18:46:50.093280 [info ] [MainThread]:   sslrootcert: None
[0m18:46:50.094415 [info ] [MainThread]:   application_name: dbt
[0m18:46:50.095485 [info ] [MainThread]:   retries: 1
[0m18:46:50.096666 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:46:50.158128 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:46:50.178027 [debug] [MainThread]: Using postgres connection "debug"
[0m18:46:50.178948 [debug] [MainThread]: On debug: select 1 as id
[0m18:46:50.179798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:50.183976 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m18:46:50.185347 [debug] [MainThread]: On debug: Close
[0m18:46:50.186246 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:46:50.187148 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:46:50.188451 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3357491, "process_user_time": 1.304458, "process_kernel_time": 0.069175, "process_mem_max_rss": "95140", "process_in_blocks": "22536", "process_out_blocks": "0"}
[0m18:46:50.189525 [debug] [MainThread]: Command `dbt debug` succeeded at 18:46:50.189414 after 0.34 seconds
[0m18:46:50.190432 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:46:50.191593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f50e9cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f4fe6a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f50474eb0>]}
[0m18:46:50.192452 [debug] [MainThread]: Flushing usage events
[0m18:49:32.339611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b32e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b159b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b159b4f0>]}


============================== 18:49:32.344886 | 21130309-fb01-47a0-90a6-80cfef6393b2 ==============================
[0m18:49:32.344886 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:49:32.346412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:49:32.524462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21130309-fb01-47a0-90a6-80cfef6393b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b0c29910>]}
[0m18:49:32.572164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21130309-fb01-47a0-90a6-80cfef6393b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b0b887f0>]}
[0m18:49:32.573606 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:49:32.640623 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:49:32.740366 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:49:32.741802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21130309-fb01-47a0-90a6-80cfef6393b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b22b3f10>]}
[0m18:49:33.888799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21130309-fb01-47a0-90a6-80cfef6393b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aad52130>]}
[0m18:49:34.014925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21130309-fb01-47a0-90a6-80cfef6393b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aad221c0>]}
[0m18:49:34.015967 [info ] [MainThread]: Found 3 models, 1 source, 428 macros
[0m18:49:34.016924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21130309-fb01-47a0-90a6-80cfef6393b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aad22850>]}
[0m18:49:34.019277 [info ] [MainThread]: 
[0m18:49:34.020449 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:49:34.021609 [debug] [MainThread]: Command end result
[0m18:49:34.056617 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7838088, "process_user_time": 2.442244, "process_kernel_time": 0.100919, "process_mem_max_rss": "105944", "process_in_blocks": "4432", "process_out_blocks": "0"}
[0m18:49:34.058053 [debug] [MainThread]: Command `dbt test` succeeded at 18:49:34.057859 after 1.79 seconds
[0m18:49:34.059280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b32e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aad22070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51aad22130>]}
[0m18:49:34.060369 [debug] [MainThread]: Flushing usage events
[0m18:50:03.894046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601cb3bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601adf0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601adf0430>]}


============================== 18:50:03.899128 | ce60c3d4-545a-485f-8f0f-3e3161e7b041 ==============================
[0m18:50:03.899128 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:50:03.900268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:50:04.043844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce60c3d4-545a-485f-8f0f-3e3161e7b041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601ba64d30>]}
[0m18:50:04.089976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce60c3d4-545a-485f-8f0f-3e3161e7b041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601ae1a7c0>]}
[0m18:50:04.091749 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:50:04.156606 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:50:04.360832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:04.361966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:04.398851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce60c3d4-545a-485f-8f0f-3e3161e7b041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601a02a130>]}
[0m18:50:04.507854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce60c3d4-545a-485f-8f0f-3e3161e7b041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601a06a820>]}
[0m18:50:04.509061 [info ] [MainThread]: Found 3 models, 1 source, 428 macros
[0m18:50:04.510173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce60c3d4-545a-485f-8f0f-3e3161e7b041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601a325be0>]}
[0m18:50:04.513317 [info ] [MainThread]: 
[0m18:50:04.515015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:04.519808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m18:50:04.574561 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m18:50:04.575754 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:50:04.576943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:04.587129 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m18:50:04.588724 [debug] [ThreadPool]: On list_*****: Close
[0m18:50:04.592075 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m18:50:04.592936 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:50:04.593710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.596587 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m18:50:04.598136 [debug] [ThreadPool]: On list_*****: Close
[0m18:50:04.600674 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m18:50:04.601697 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:50:04.602469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.605319 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m18:50:04.606748 [debug] [ThreadPool]: On list_*****: Close
[0m18:50:04.607900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now create_*****_public_gold)
[0m18:50:04.608758 [debug] [ThreadPool]: Creating schema "database: "*****"
schema: "public_gold"
"
[0m18:50:04.614593 [debug] [ThreadPool]: Using postgres connection "create_*****_public_gold"
[0m18:50:04.615670 [debug] [ThreadPool]: On create_*****_public_gold: BEGIN
[0m18:50:04.616744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.622052 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:50:04.623107 [debug] [ThreadPool]: Using postgres connection "create_*****_public_gold"
[0m18:50:04.623916 [debug] [ThreadPool]: On create_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "create_*****_public_gold"} */
create schema if not exists "public_gold"
[0m18:50:04.626955 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m18:50:04.628210 [debug] [ThreadPool]: On create_*****_public_gold: COMMIT
[0m18:50:04.628915 [debug] [ThreadPool]: Using postgres connection "create_*****_public_gold"
[0m18:50:04.629621 [debug] [ThreadPool]: On create_*****_public_gold: COMMIT
[0m18:50:04.631334 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:50:04.632139 [debug] [ThreadPool]: On create_*****_public_gold: Close
[0m18:50:04.633272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_*****_public_gold, now create_*****_public_silver)
[0m18:50:04.634178 [debug] [ThreadPool]: Creating schema "database: "*****"
schema: "public_silver"
"
[0m18:50:04.637447 [debug] [ThreadPool]: Using postgres connection "create_*****_public_silver"
[0m18:50:04.638259 [debug] [ThreadPool]: On create_*****_public_silver: BEGIN
[0m18:50:04.639140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.642343 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.643400 [debug] [ThreadPool]: Using postgres connection "create_*****_public_silver"
[0m18:50:04.644170 [debug] [ThreadPool]: On create_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "create_*****_public_silver"} */
create schema if not exists "public_silver"
[0m18:50:04.645183 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m18:50:04.646455 [debug] [ThreadPool]: On create_*****_public_silver: COMMIT
[0m18:50:04.647183 [debug] [ThreadPool]: Using postgres connection "create_*****_public_silver"
[0m18:50:04.647925 [debug] [ThreadPool]: On create_*****_public_silver: COMMIT
[0m18:50:04.649149 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:50:04.649890 [debug] [ThreadPool]: On create_*****_public_silver: Close
[0m18:50:04.651174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_*****_public_silver, now create_*****_public_bronze)
[0m18:50:04.652367 [debug] [ThreadPool]: Creating schema "database: "*****"
schema: "public_bronze"
"
[0m18:50:04.654949 [debug] [ThreadPool]: Using postgres connection "create_*****_public_bronze"
[0m18:50:04.655702 [debug] [ThreadPool]: On create_*****_public_bronze: BEGIN
[0m18:50:04.656387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.658936 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.659671 [debug] [ThreadPool]: Using postgres connection "create_*****_public_bronze"
[0m18:50:04.660409 [debug] [ThreadPool]: On create_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "create_*****_public_bronze"} */
create schema if not exists "public_bronze"
[0m18:50:04.661530 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m18:50:04.662887 [debug] [ThreadPool]: On create_*****_public_bronze: COMMIT
[0m18:50:04.663634 [debug] [ThreadPool]: Using postgres connection "create_*****_public_bronze"
[0m18:50:04.664348 [debug] [ThreadPool]: On create_*****_public_bronze: COMMIT
[0m18:50:04.665594 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:50:04.666334 [debug] [ThreadPool]: On create_*****_public_bronze: Close
[0m18:50:04.667992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_*****_public_bronze, now list_*****_public_gold)
[0m18:50:04.677580 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m18:50:04.678944 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m18:50:04.679951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.683199 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.684055 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m18:50:04.684852 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m18:50:04.691636 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m18:50:04.693395 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m18:50:04.694417 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m18:50:04.695468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_silver)
[0m18:50:04.697955 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m18:50:04.698814 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m18:50:04.699620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.702862 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.703752 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m18:50:04.704536 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m18:50:04.706945 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m18:50:04.708392 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m18:50:04.709199 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m18:50:04.710320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_bronze)
[0m18:50:04.713328 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m18:50:04.714213 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m18:50:04.714930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:04.717449 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.718215 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m18:50:04.718960 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m18:50:04.721095 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:50:04.722787 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m18:50:04.723643 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m18:50:04.728336 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:04.729127 [debug] [MainThread]: On master: BEGIN
[0m18:50:04.729842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:04.732633 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.733513 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:04.734270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:04.738780 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:50:04.740185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce60c3d4-545a-485f-8f0f-3e3161e7b041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601a02bac0>]}
[0m18:50:04.741030 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:04.742177 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:04.742935 [debug] [MainThread]: On master: BEGIN
[0m18:50:04.743805 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:50:04.744442 [debug] [MainThread]: On master: COMMIT
[0m18:50:04.745088 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:04.745686 [debug] [MainThread]: On master: COMMIT
[0m18:50:04.746403 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:04.747616 [debug] [MainThread]: On master: Close
[0m18:50:04.749603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:04.750433 [info ] [MainThread]: 
[0m18:50:04.757239 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.financial_data
[0m18:50:04.758322 [info ] [Thread-1  ]: 1 of 3 START sql table model public_bronze.financial_data ...................... [RUN]
[0m18:50:04.759328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now model.financial_data_pipeline.financial_data)
[0m18:50:04.760134 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.financial_data
[0m18:50:04.768086 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.financial_data"
[0m18:50:04.777821 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.financial_data
[0m18:50:04.815972 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.financial_data"
[0m18:50:04.825058 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m18:50:04.825881 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: BEGIN
[0m18:50:04.826655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:04.829386 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.830403 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m18:50:04.831706 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.financial_data"} */

  
    

  create  table "*****"."public_bronze"."financial_data__dbt_tmp"
  
  
    as
  
  (
    select
    *
from "*****"."bronze"."financial_data"
  );
  
[0m18:50:04.833086 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "bronze.financial_data" does not exist
LINE 14: from "*****"."bronze"."financial_data"
              ^

[0m18:50:04.834066 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: ROLLBACK
[0m18:50:04.835062 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: Close
[0m18:50:04.839946 [debug] [Thread-1  ]: Database Error in model financial_data (models/bronze/financial_data.sql)
  relation "bronze.financial_data" does not exist
  LINE 14: from "*****"."bronze"."financial_data"
                ^
  compiled code at target/run/financial_data_pipeline/models/bronze/financial_data.sql
[0m18:50:04.842191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce60c3d4-545a-485f-8f0f-3e3161e7b041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601a02bac0>]}
[0m18:50:04.843301 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model public_bronze.financial_data ............. [[31mERROR[0m in 0.08s]
[0m18:50:04.844376 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.financial_data
[0m18:50:04.845700 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m18:50:04.846562 [info ] [Thread-1  ]: 2 of 3 SKIP relation public_silver.cleaned_financial_data ...................... [[33mSKIP[0m]
[0m18:50:04.847453 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m18:50:04.848610 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m18:50:04.849355 [info ] [Thread-1  ]: 3 of 3 SKIP relation public_gold.aggregated_financial_data ..................... [[33mSKIP[0m]
[0m18:50:04.850211 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m18:50:04.851891 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:04.852602 [debug] [MainThread]: On master: BEGIN
[0m18:50:04.853170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:04.855816 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:50:04.856570 [debug] [MainThread]: On master: COMMIT
[0m18:50:04.857244 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:04.857831 [debug] [MainThread]: On master: COMMIT
[0m18:50:04.858525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:04.859087 [debug] [MainThread]: On master: Close
[0m18:50:04.859774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:04.860447 [debug] [MainThread]: Connection 'model.financial_data_pipeline.financial_data' was properly closed.
[0m18:50:04.861638 [info ] [MainThread]: 
[0m18:50:04.863218 [info ] [MainThread]: Finished running 2 table models, 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:50:04.864650 [debug] [MainThread]: Command end result
[0m18:50:04.903914 [info ] [MainThread]: 
[0m18:50:04.905466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:04.906710 [info ] [MainThread]: 
[0m18:50:04.907712 [error] [MainThread]:   Database Error in model financial_data (models/bronze/financial_data.sql)
  relation "bronze.financial_data" does not exist
  LINE 14: from "*****"."bronze"."financial_data"
                ^
  compiled code at target/run/financial_data_pipeline/models/bronze/financial_data.sql
[0m18:50:04.908650 [info ] [MainThread]: 
[0m18:50:04.909640 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m18:50:04.911167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0778605, "process_user_time": 1.775329, "process_kernel_time": 0.082573, "process_mem_max_rss": "104384", "process_in_blocks": "328", "command_success": false, "process_out_blocks": "0"}
[0m18:50:04.912239 [debug] [MainThread]: Command `dbt run` failed at 18:50:04.912124 after 1.08 seconds
[0m18:50:04.913062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601cb3bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601b5ba0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601afb7be0>]}
[0m18:50:04.913960 [debug] [MainThread]: Flushing usage events
[0m18:53:47.431671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7549bb4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7547e69520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7547e694c0>]}


============================== 18:53:47.437811 | afef5ed7-0c26-435e-8c27-b78c5baff02b ==============================
[0m18:53:47.437811 [info ] [MainThread]: Running with dbt=1.8.0
[0m18:53:47.439377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:47.663082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afef5ed7-0c26-435e-8c27-b78c5baff02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75474c5b20>]}
[0m18:53:47.709826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afef5ed7-0c26-435e-8c27-b78c5baff02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7548532610>]}
[0m18:53:47.711224 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:53:47.773126 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m18:53:48.002252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:48.003054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:48.038659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afef5ed7-0c26-435e-8c27-b78c5baff02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75470a4130>]}
[0m18:53:48.153693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afef5ed7-0c26-435e-8c27-b78c5baff02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754719f0d0>]}
[0m18:53:48.154563 [info ] [MainThread]: Found 3 models, 1 source, 428 macros
[0m18:53:48.155825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afef5ed7-0c26-435e-8c27-b78c5baff02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754739c730>]}
[0m18:53:48.158094 [info ] [MainThread]: 
[0m18:53:48.159326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:53:48.163760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m18:53:48.220051 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m18:53:48.221420 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:53:48.222402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:48.226872 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m18:53:48.228359 [debug] [ThreadPool]: On list_*****: Close
[0m18:53:48.231060 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m18:53:48.231800 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:53:48.232641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:48.235492 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m18:53:48.237191 [debug] [ThreadPool]: On list_*****: Close
[0m18:53:48.240622 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m18:53:48.241964 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m18:53:48.243071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:48.247167 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m18:53:48.248663 [debug] [ThreadPool]: On list_*****: Close
[0m18:53:48.250592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_gold)
[0m18:53:48.259133 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m18:53:48.260070 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m18:53:48.260899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:48.264042 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:53:48.265068 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m18:53:48.265926 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m18:53:48.268182 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:53:48.270247 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m18:53:48.271594 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m18:53:48.272918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_silver)
[0m18:53:48.276302 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m18:53:48.277087 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m18:53:48.277820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:48.280457 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:53:48.281468 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m18:53:48.282367 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m18:53:48.284562 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:53:48.285994 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m18:53:48.286927 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m18:53:48.288120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_bronze)
[0m18:53:48.290616 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m18:53:48.291364 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m18:53:48.292310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:48.295313 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:53:48.296233 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m18:53:48.297270 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m18:53:48.299441 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:53:48.301028 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m18:53:48.301872 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m18:53:48.307719 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:48.308941 [debug] [MainThread]: On master: BEGIN
[0m18:53:48.310128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:48.313801 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m18:53:48.314940 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:48.316002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:48.321128 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:53:48.323201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afef5ed7-0c26-435e-8c27-b78c5baff02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f754704f670>]}
[0m18:53:48.324328 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:48.325281 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:48.326017 [debug] [MainThread]: On master: BEGIN
[0m18:53:48.326981 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:53:48.327663 [debug] [MainThread]: On master: COMMIT
[0m18:53:48.328396 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:48.329069 [debug] [MainThread]: On master: COMMIT
[0m18:53:48.329885 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:53:48.330565 [debug] [MainThread]: On master: Close
[0m18:53:48.331488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:48.332373 [info ] [MainThread]: 
[0m18:53:48.338997 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.financial_data
[0m18:53:48.340149 [info ] [Thread-1  ]: 1 of 3 START sql table model public_bronze.financial_data ...................... [RUN]
[0m18:53:48.341183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now model.financial_data_pipeline.financial_data)
[0m18:53:48.342033 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.financial_data
[0m18:53:48.350478 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.financial_data"
[0m18:53:48.355841 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.financial_data
[0m18:53:48.399342 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.financial_data"
[0m18:53:48.405527 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m18:53:48.406420 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: BEGIN
[0m18:53:48.407220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:53:48.410069 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m18:53:48.410978 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m18:53:48.411924 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.financial_data"} */

  
    

  create  table "*****"."public_bronze"."financial_data__dbt_tmp"
  
  
    as
  
  (
    select
    *
from "*****"."bronze"."financial_data"
  );
  
[0m18:53:48.413502 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "bronze.financial_data" does not exist
LINE 14: from "*****"."bronze"."financial_data"
              ^

[0m18:53:48.414296 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: ROLLBACK
[0m18:53:48.415299 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: Close
[0m18:53:48.419755 [debug] [Thread-1  ]: Database Error in model financial_data (models/bronze/financial_data.sql)
  relation "bronze.financial_data" does not exist
  LINE 14: from "*****"."bronze"."financial_data"
                ^
  compiled code at target/run/financial_data_pipeline/models/bronze/financial_data.sql
[0m18:53:48.421918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afef5ed7-0c26-435e-8c27-b78c5baff02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7546451bb0>]}
[0m18:53:48.423161 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model public_bronze.financial_data ............. [[31mERROR[0m in 0.08s]
[0m18:53:48.424452 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.financial_data
[0m18:53:48.425912 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m18:53:48.426823 [info ] [Thread-1  ]: 2 of 3 SKIP relation public_silver.cleaned_financial_data ...................... [[33mSKIP[0m]
[0m18:53:48.427791 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m18:53:48.429125 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m18:53:48.429954 [info ] [Thread-1  ]: 3 of 3 SKIP relation public_gold.aggregated_financial_data ..................... [[33mSKIP[0m]
[0m18:53:48.430875 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m18:53:48.432434 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:48.433155 [debug] [MainThread]: On master: BEGIN
[0m18:53:48.433842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:48.436589 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:53:48.437399 [debug] [MainThread]: On master: COMMIT
[0m18:53:48.438199 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:48.438855 [debug] [MainThread]: On master: COMMIT
[0m18:53:48.439636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:53:48.440317 [debug] [MainThread]: On master: Close
[0m18:53:48.441160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:48.441883 [debug] [MainThread]: Connection 'model.financial_data_pipeline.financial_data' was properly closed.
[0m18:53:48.442648 [info ] [MainThread]: 
[0m18:53:48.443452 [info ] [MainThread]: Finished running 2 table models, 1 incremental model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m18:53:48.444573 [debug] [MainThread]: Command end result
[0m18:53:48.487221 [info ] [MainThread]: 
[0m18:53:48.488541 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:53:48.489591 [info ] [MainThread]: 
[0m18:53:48.490634 [error] [MainThread]:   Database Error in model financial_data (models/bronze/financial_data.sql)
  relation "bronze.financial_data" does not exist
  LINE 14: from "*****"."bronze"."financial_data"
                ^
  compiled code at target/run/financial_data_pipeline/models/bronze/financial_data.sql
[0m18:53:48.491561 [info ] [MainThread]: 
[0m18:53:48.492665 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m18:53:48.494449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1168668, "process_user_time": 1.819456, "process_kernel_time": 0.142889, "process_mem_max_rss": "102724", "process_in_blocks": "48440", "command_success": false, "process_out_blocks": "0"}
[0m18:53:48.495571 [debug] [MainThread]: Command `dbt run` failed at 18:53:48.495438 after 1.12 seconds
[0m18:53:48.496467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7549bb4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75473ca490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7546ff89d0>]}
[0m18:53:48.497338 [debug] [MainThread]: Flushing usage events
[0m19:15:33.518945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07839c7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0781c725b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0781c72550>]}


============================== 19:15:33.525335 | 142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52 ==============================
[0m19:15:33.525335 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:15:33.526733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:33.746078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07835db430>]}
[0m19:15:33.795536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0781e17b20>]}
[0m19:15:33.797279 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:33.870941 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m19:15:34.125034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m19:15:34.125975 [debug] [MainThread]: Partial parsing: added file: financial_data_pipeline://macros/read_json_directory.sql
[0m19:15:34.126976 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/bronze/schema.yml
[0m19:15:34.127932 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/silver/cleaned_financial_data.sql
[0m19:15:34.128755 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/bronze/financial_data.sql
[0m19:15:34.129590 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/gold/aggregated_financial_data.sql
[0m19:15:34.484352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078128ea60>]}
[0m19:15:34.598272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0780e4e430>]}
[0m19:15:34.599557 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m19:15:34.600683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07801264f0>]}
[0m19:15:34.603098 [info ] [MainThread]: 
[0m19:15:34.604480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:34.610273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m19:15:34.644026 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m19:15:34.645106 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m19:15:34.645836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:34.650403 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m19:15:34.651982 [debug] [ThreadPool]: On list_*****: Close
[0m19:15:34.654817 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m19:15:34.655660 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m19:15:34.656433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:34.659712 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m19:15:34.661408 [debug] [ThreadPool]: On list_*****: Close
[0m19:15:34.664065 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m19:15:34.664994 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m19:15:34.665670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:34.668647 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m19:15:34.670149 [debug] [ThreadPool]: On list_*****: Close
[0m19:15:34.671821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_bronze)
[0m19:15:34.678150 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m19:15:34.678976 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m19:15:34.679694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:34.683062 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m19:15:34.683891 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m19:15:34.684754 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m19:15:34.688219 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:15:34.689786 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m19:15:34.690644 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m19:15:34.691699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_silver)
[0m19:15:34.694179 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m19:15:34.694935 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m19:15:34.695646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:34.698431 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m19:15:34.699187 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m19:15:34.699887 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m19:15:34.702276 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m19:15:34.703966 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m19:15:34.704789 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m19:15:34.705846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_gold)
[0m19:15:34.708379 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m19:15:34.709112 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m19:15:34.709836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:34.712512 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m19:15:34.713250 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m19:15:34.714007 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m19:15:34.716761 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m19:15:34.720724 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m19:15:34.722276 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m19:15:34.728128 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:34.728921 [debug] [MainThread]: On master: BEGIN
[0m19:15:34.729691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:34.732371 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:15:34.733139 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:34.733910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:34.737705 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m19:15:34.739175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07800bd280>]}
[0m19:15:34.740002 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:34.740841 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:34.741546 [debug] [MainThread]: On master: BEGIN
[0m19:15:34.742469 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:15:34.743186 [debug] [MainThread]: On master: COMMIT
[0m19:15:34.744042 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:34.744901 [debug] [MainThread]: On master: COMMIT
[0m19:15:34.745800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:15:34.746718 [debug] [MainThread]: On master: Close
[0m19:15:34.747700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:34.748922 [info ] [MainThread]: 
[0m19:15:34.755507 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m19:15:34.756655 [info ] [Thread-1  ]: 1 of 3 START sql incremental model public_silver.cleaned_financial_data ........ [RUN]
[0m19:15:34.757692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_gold, now model.financial_data_pipeline.cleaned_financial_data)
[0m19:15:34.758664 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.cleaned_financial_data
[0m19:15:34.767080 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.cleaned_financial_data"
[0m19:15:34.774806 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.cleaned_financial_data
[0m19:15:34.824779 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.cleaned_financial_data"
[0m19:15:34.831680 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m19:15:34.832598 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: BEGIN
[0m19:15:34.833393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:15:34.836412 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m19:15:34.837377 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m19:15:34.838097 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      
  
    

  create  table "*****"."public_silver"."cleaned_financial_data"
  
  
    as
  
  (
    with cleaned as (
    select
        symbol,
        avg(price) as avg_price,
        sum(volume) as total_volume,
        date_trunc('day', timestamp) as trading_day
    from "*****"."bronze"."financial_data"
    group by symbol, trading_day
)

select * from cleaned
  );
  
  
[0m19:15:34.839166 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "bronze.financial_data" does not exist
LINE 19:     from "*****"."bronze"."financial_data"
                  ^

[0m19:15:34.840013 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: ROLLBACK
[0m19:15:34.840893 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: Close
[0m19:15:34.845046 [debug] [Thread-1  ]: Database Error in model cleaned_financial_data (models/silver/cleaned_financial_data.sql)
  relation "bronze.financial_data" does not exist
  LINE 19:     from "*****"."bronze"."financial_data"
                    ^
  compiled code at target/run/financial_data_pipeline/models/silver/cleaned_financial_data.sql
[0m19:15:34.846837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07828d1700>]}
[0m19:15:34.847819 [error] [Thread-1  ]: 1 of 3 ERROR creating sql incremental model public_silver.cleaned_financial_data  [[31mERROR[0m in 0.09s]
[0m19:15:34.848868 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m19:15:34.849740 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.financial_data
[0m19:15:34.850946 [info ] [Thread-1  ]: 2 of 3 START sql table model public_bronze.financial_data ...................... [RUN]
[0m19:15:34.852154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financial_data_pipeline.cleaned_financial_data, now model.financial_data_pipeline.financial_data)
[0m19:15:34.853446 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.financial_data
[0m19:15:34.856639 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.financial_data"
[0m19:15:34.861097 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.financial_data
[0m19:15:34.874612 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.financial_data"
[0m19:15:34.880614 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m19:15:34.881863 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: BEGIN
[0m19:15:34.882898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:15:34.885738 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m19:15:34.886681 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m19:15:34.887473 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.financial_data"} */

  
    

  create  table "*****"."public_bronze"."financial_data__dbt_tmp"
  
  
    as
  
  (
    with raw_data as (
    select
        *
    from read_json_directory('/usr/local/*****/data/bronze/*')
)

select
    symbol,
    price,
    volume,
    cast(timestamp as timestamp) as timestamp
from raw_data
  );
  
[0m19:15:34.891435 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function read_json_directory(unknown) does not exist
LINE 15:     from read_json_directory('/usr/local/*****/data/bronze...
                  ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:15:34.892453 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: ROLLBACK
[0m19:15:34.893516 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: Close
[0m19:15:34.894931 [debug] [Thread-1  ]: Database Error in model financial_data (models/bronze/financial_data.sql)
  function read_json_directory(unknown) does not exist
  LINE 15:     from read_json_directory('/usr/local/*****/data/bronze...
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/financial_data_pipeline/models/bronze/financial_data.sql
[0m19:15:34.895765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '142e4d7c-43a1-4c2d-9aaa-4ac7ae6f5d52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0768f70100>]}
[0m19:15:34.896758 [error] [Thread-1  ]: 2 of 3 ERROR creating sql table model public_bronze.financial_data ............. [[31mERROR[0m in 0.04s]
[0m19:15:34.897968 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.financial_data
[0m19:15:34.899032 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m19:15:34.899942 [info ] [Thread-1  ]: 3 of 3 SKIP relation public_gold.aggregated_financial_data ..................... [[33mSKIP[0m]
[0m19:15:34.900931 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m19:15:34.902707 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:34.903497 [debug] [MainThread]: On master: BEGIN
[0m19:15:34.904158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:34.906963 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:15:34.907759 [debug] [MainThread]: On master: COMMIT
[0m19:15:34.908479 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:34.909166 [debug] [MainThread]: On master: COMMIT
[0m19:15:34.909953 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:15:34.910782 [debug] [MainThread]: On master: Close
[0m19:15:34.911690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:34.912667 [debug] [MainThread]: Connection 'model.financial_data_pipeline.financial_data' was properly closed.
[0m19:15:34.913499 [info ] [MainThread]: 
[0m19:15:34.914636 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m19:15:34.916049 [debug] [MainThread]: Command end result
[0m19:15:34.955951 [info ] [MainThread]: 
[0m19:15:34.957251 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:15:34.958540 [info ] [MainThread]: 
[0m19:15:34.959554 [error] [MainThread]:   Database Error in model cleaned_financial_data (models/silver/cleaned_financial_data.sql)
  relation "bronze.financial_data" does not exist
  LINE 19:     from "*****"."bronze"."financial_data"
                    ^
  compiled code at target/run/financial_data_pipeline/models/silver/cleaned_financial_data.sql
[0m19:15:34.960494 [info ] [MainThread]: 
[0m19:15:34.961448 [error] [MainThread]:   Database Error in model financial_data (models/bronze/financial_data.sql)
  function read_json_directory(unknown) does not exist
  LINE 15:     from read_json_directory('/usr/local/*****/data/bronze...
                    ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/financial_data_pipeline/models/bronze/financial_data.sql
[0m19:15:34.962405 [info ] [MainThread]: 
[0m19:15:34.963364 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m19:15:34.965274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5031283, "process_user_time": 2.072803, "process_kernel_time": 0.16164, "process_mem_max_rss": "109968", "process_in_blocks": "48880", "command_success": false, "process_out_blocks": "0"}
[0m19:15:34.966719 [debug] [MainThread]: Command `dbt run` failed at 19:15:34.966603 after 1.50 seconds
[0m19:15:34.967689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07839c7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0780e1a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078238e400>]}
[0m19:15:34.968648 [debug] [MainThread]: Flushing usage events
[0m19:57:43.151382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab368bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab2d47d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab1942130>]}


============================== 19:57:43.158041 | 1860e172-a6a8-43bc-a8a7-7e6e343a5ffb ==============================
[0m19:57:43.158041 [info ] [MainThread]: Running with dbt=1.8.0
[0m19:57:43.158987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select bronze', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:57:43.166208 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m19:57:43.167610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.074312486, "process_user_time": 1.151956, "process_kernel_time": 0.092567, "process_mem_max_rss": "83148", "process_in_blocks": "40000", "command_success": false, "process_out_blocks": "0"}
[0m19:57:43.168522 [debug] [MainThread]: Command `dbt run` failed at 19:57:43.168419 after 0.08 seconds
[0m19:57:43.169257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab368bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab1b19e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab1ae7880>]}
[0m19:57:43.169923 [debug] [MainThread]: Flushing usage events
[0m20:27:41.831373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4db4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4470d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d306b130>]}


============================== 20:27:41.837981 | c485b5aa-f085-4cf9-b44e-b894c3619fea ==============================
[0m20:27:41.837981 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:27:41.838984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'send_anonymous_usage_stats': 'True'}
[0m20:27:41.847118 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m20:27:41.848663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07078413, "process_user_time": 1.184877, "process_kernel_time": 0.081715, "process_mem_max_rss": "83124", "process_in_blocks": "39608", "command_success": false, "process_out_blocks": "0"}
[0m20:27:41.849682 [debug] [MainThread]: Command `dbt run` failed at 20:27:41.849549 after 0.07 seconds
[0m20:27:41.850463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4db4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d3780670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d3242100>]}
[0m20:27:41.851224 [debug] [MainThread]: Flushing usage events
[0m20:32:46.597602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d1a5de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cfd142b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cfd14250>]}


============================== 20:32:46.603920 | 4c89438f-e08e-4ccf-b167-8db966e0b47f ==============================
[0m20:32:46.603920 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:32:46.604968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:46.611987 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m20:32:46.613370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07144924, "process_user_time": 1.194799, "process_kernel_time": 0.051499, "process_mem_max_rss": "83072", "process_in_blocks": "39640", "command_success": false, "process_out_blocks": "0"}
[0m20:32:46.614271 [debug] [MainThread]: Command `dbt run` failed at 20:32:46.614165 after 0.07 seconds
[0m20:32:46.615054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d1a5de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cfd839a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cfd83400>]}
[0m20:32:46.615765 [debug] [MainThread]: Flushing usage events
[0m20:48:46.055313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0383070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcce631610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcce6315b0>]}


============================== 20:48:46.061303 | 46a537d9-9091-49d2-9ce6-1be3dacd4994 ==============================
[0m20:48:46.061303 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:48:46.062545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select silver', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:48:46.208094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a537d9-9091-49d2-9ce6-1be3dacd4994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdccff97430>]}
[0m20:48:46.254145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a537d9-9091-49d2-9ce6-1be3dacd4994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdccf2ac9d0>]}
[0m20:48:46.255557 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:48:46.328920 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:48:46.419982 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:48:46.421282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46a537d9-9091-49d2-9ce6-1be3dacd4994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdccf99e2e0>]}
[0m20:48:47.538719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a537d9-9091-49d2-9ce6-1be3dacd4994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca7db6130>]}
[0m20:48:47.651453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a537d9-9091-49d2-9ce6-1be3dacd4994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca7d28b50>]}
[0m20:48:47.652847 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:48:47.654269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a537d9-9091-49d2-9ce6-1be3dacd4994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca7d8f460>]}
[0m20:48:47.656394 [info ] [MainThread]: 
[0m20:48:47.657808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:47.659442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:48:47.690244 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:48:47.691452 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:48:47.692580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:47.694046 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not connect to server: Connection refused
	Is the server running on host "localhost" (::1) and accepting
	TCP/IP connections on port 5432?
could not connect to server: Connection refused
	Is the server running on host "localhost" (127.0.0.1) and accepting
	TCP/IP connections on port 5432?

[0m20:48:47.695470 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:48:47.696552 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:48:47.697367 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:48:47.698147 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:48:47.698954 [debug] [ThreadPool]: On list_*****: No close available on handle
[0m20:48:47.700302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:47.701050 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m20:48:47.701820 [info ] [MainThread]: 
[0m20:48:47.702689 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m20:48:47.703702 [error] [MainThread]: Encountered an error:
Database Error
  could not connect to server: Connection refused
  	Is the server running on host "localhost" (::1) and accepting
  	TCP/IP connections on port 5432?
  could not connect to server: Connection refused
  	Is the server running on host "localhost" (127.0.0.1) and accepting
  	TCP/IP connections on port 5432?
  
[0m20:48:47.705545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7020464, "process_user_time": 2.570692, "process_kernel_time": 0.039701, "process_mem_max_rss": "108008", "process_in_blocks": "1968", "command_success": false, "process_out_blocks": "0"}
[0m20:48:47.706574 [debug] [MainThread]: Command `dbt run` failed at 20:48:47.706473 after 1.70 seconds
[0m20:48:47.707440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd0383070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca7dd8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca7d8f430>]}
[0m20:48:47.708215 [debug] [MainThread]: Flushing usage events
[0m20:49:27.045975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd947bc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd92a6a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd92a6a4f0>]}


============================== 20:49:27.052120 | d6305b5f-eaa6-420b-9cde-0ea490b961ea ==============================
[0m20:49:27.052120 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:49:27.053827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select silver', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:49:27.201281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd92a84b80>]}
[0m20:49:27.253483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd92a840a0>]}
[0m20:49:27.254992 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:49:27.317406 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:49:27.418716 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:49:27.419800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd93710a60>]}
[0m20:49:28.545842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd90252130>]}
[0m20:49:28.647395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd90250910>]}
[0m20:49:28.648952 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:49:28.650374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd9021a790>]}
[0m20:49:28.652850 [info ] [MainThread]: 
[0m20:49:28.654267 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:49:28.656272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:49:28.683755 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:49:28.684971 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:49:28.685781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:28.696837 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m20:49:28.698398 [debug] [ThreadPool]: On list_*****: Close
[0m20:49:28.700076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_bronze)
[0m20:49:28.705890 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:49:28.706638 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:49:28.707434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:28.710022 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:49:28.710789 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:49:28.711537 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:49:28.718303 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m20:49:28.720151 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:49:28.721291 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:49:28.722826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_silver)
[0m20:49:28.725446 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:49:28.726207 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:49:28.726956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:28.729674 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:49:28.730500 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:49:28.731334 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:49:28.733654 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:49:28.735065 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:49:28.735927 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:49:28.737067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_gold)
[0m20:49:28.739569 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:49:28.740295 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:49:28.741071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:28.743933 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:49:28.745122 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:49:28.745973 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:49:28.748228 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:49:28.749684 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:49:28.750512 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:49:28.755102 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:28.755903 [debug] [MainThread]: On master: BEGIN
[0m20:49:28.756771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:28.759287 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:49:28.760114 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:28.760927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:49:28.768675 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m20:49:28.770146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd90219d60>]}
[0m20:49:28.771101 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:28.771917 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:28.772629 [debug] [MainThread]: On master: BEGIN
[0m20:49:28.773623 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:49:28.774310 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.775006 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:28.775729 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.776605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:28.777398 [debug] [MainThread]: On master: Close
[0m20:49:28.778516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:28.779767 [info ] [MainThread]: 
[0m20:49:28.789333 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m20:49:28.790346 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public_silver.cleaned_financial_data ........ [RUN]
[0m20:49:28.791511 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_gold, now model.financial_data_pipeline.cleaned_financial_data)
[0m20:49:28.792556 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.cleaned_financial_data
[0m20:49:28.800087 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.cleaned_financial_data"
[0m20:49:28.804936 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.cleaned_financial_data
[0m20:49:28.891408 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.cleaned_financial_data"
[0m20:49:28.896056 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:49:28.896957 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: BEGIN
[0m20:49:28.897818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:28.901390 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m20:49:28.902305 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:49:28.903623 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      
  
    

  create  table "*****"."public_silver"."cleaned_financial_data"
  
  
    as
  
  (
    -- Modelo da camada Silver
with raw_data as (
    select
        *,
        cast(price as numeric(10, 2)) as price_numeric,
        cast(date as date) as transaction_date
    from bronze.bronze_financial_data
),
cleaned_data as (
    select
        ticker,
        price_numeric as price,
        transaction_date as date
    from raw_data
    where price_numeric > 0  -- Exclui valores de preço inválidos
)

select
    *
from cleaned_data
  );
  
  
[0m20:49:28.905491 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "bronze.bronze_financial_data" does not exist
LINE 19:     from bronze.bronze_financial_data
                  ^

[0m20:49:28.907177 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: ROLLBACK
[0m20:49:28.908138 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: Close
[0m20:49:28.910412 [debug] [Thread-1  ]: Database Error in model cleaned_financial_data (models/silver/cleaned_financial_data.sql)
  relation "bronze.bronze_financial_data" does not exist
  LINE 19:     from bronze.bronze_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/silver/cleaned_financial_data.sql
[0m20:49:28.912325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6305b5f-eaa6-420b-9cde-0ea490b961ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd91d9c4f0>]}
[0m20:49:28.913373 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model public_silver.cleaned_financial_data  [[31mERROR[0m in 0.12s]
[0m20:49:28.914629 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m20:49:28.916383 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:28.917300 [debug] [MainThread]: On master: BEGIN
[0m20:49:28.918137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:28.920893 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:49:28.921679 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.922437 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:28.923380 [debug] [MainThread]: On master: COMMIT
[0m20:49:28.924198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:28.924911 [debug] [MainThread]: On master: Close
[0m20:49:28.925819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:28.926723 [debug] [MainThread]: Connection 'model.financial_data_pipeline.cleaned_financial_data' was properly closed.
[0m20:49:28.927496 [info ] [MainThread]: 
[0m20:49:28.928476 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m20:49:28.929972 [debug] [MainThread]: Command end result
[0m20:49:28.971603 [info ] [MainThread]: 
[0m20:49:28.972917 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:28.974209 [info ] [MainThread]: 
[0m20:49:28.975376 [error] [MainThread]:   Database Error in model cleaned_financial_data (models/silver/cleaned_financial_data.sql)
  relation "bronze.bronze_financial_data" does not exist
  LINE 19:     from bronze.bronze_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/silver/cleaned_financial_data.sql
[0m20:49:28.976481 [info ] [MainThread]: 
[0m20:49:28.977909 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:49:28.979700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9877789, "process_user_time": 2.677559, "process_kernel_time": 0.079335, "process_mem_max_rss": "108932", "process_in_blocks": "56", "command_success": false, "process_out_blocks": "0"}
[0m20:49:28.980915 [debug] [MainThread]: Command `dbt run` failed at 20:49:28.980794 after 1.99 seconds
[0m20:49:28.981913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd947bc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd93107fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd93d0e3a0>]}
[0m20:49:28.982743 [debug] [MainThread]: Flushing usage events
[0m20:50:24.623288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3254b8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe323766610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3237665b0>]}


============================== 20:50:24.628340 | 678fed54-da26-4c62-845f-af75930b4420 ==============================
[0m20:50:24.628340 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:50:24.629580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'profiles_dir': '/usr/local/*****/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select silver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:50:24.784379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '678fed54-da26-4c62-845f-af75930b4420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3250cb430>]}
[0m20:50:24.831192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '678fed54-da26-4c62-845f-af75930b4420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3243e19d0>]}
[0m20:50:24.832918 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:50:24.901697 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:50:25.103252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:50:25.104503 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/silver/cleaned_financial_data.sql
[0m20:50:25.105780 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/gold/aggregated_financial_data.sql
[0m20:50:25.407558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '678fed54-da26-4c62-845f-af75930b4420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe322de9fa0>]}
[0m20:50:25.509377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '678fed54-da26-4c62-845f-af75930b4420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3211e28e0>]}
[0m20:50:25.510316 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:50:25.511997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678fed54-da26-4c62-845f-af75930b4420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3211f59a0>]}
[0m20:50:25.514489 [info ] [MainThread]: 
[0m20:50:25.515967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:25.517699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:50:25.545340 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:50:25.546518 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:50:25.547708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:25.551739 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m20:50:25.553882 [debug] [ThreadPool]: On list_*****: Close
[0m20:50:25.555787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_gold)
[0m20:50:25.562305 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:50:25.563341 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:50:25.564208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:25.567264 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:50:25.568054 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:50:25.568905 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:50:25.571214 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:50:25.572810 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:50:25.573706 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:50:25.574720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_bronze)
[0m20:50:25.577438 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:50:25.578255 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:50:25.578995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:25.582083 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:50:25.582870 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:50:25.583618 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:50:25.585862 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:50:25.587376 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:50:25.588155 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:50:25.589159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_silver)
[0m20:50:25.591685 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:50:25.592482 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:50:25.593260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:25.595927 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:50:25.596707 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:50:25.597496 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:50:25.599965 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:50:25.601455 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:50:25.602300 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:50:25.607541 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:25.608987 [debug] [MainThread]: On master: BEGIN
[0m20:50:25.609752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:25.612597 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:50:25.613363 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:25.614181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:25.618349 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m20:50:25.619820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678fed54-da26-4c62-845f-af75930b4420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe322df8850>]}
[0m20:50:25.620693 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:25.621511 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:25.622304 [debug] [MainThread]: On master: BEGIN
[0m20:50:25.623197 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:50:25.623903 [debug] [MainThread]: On master: COMMIT
[0m20:50:25.624690 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:25.625487 [debug] [MainThread]: On master: COMMIT
[0m20:50:25.626318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:25.627047 [debug] [MainThread]: On master: Close
[0m20:50:25.627957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:25.628876 [info ] [MainThread]: 
[0m20:50:25.634927 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m20:50:25.636037 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public_silver.cleaned_financial_data ........ [RUN]
[0m20:50:25.637078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_silver, now model.financial_data_pipeline.cleaned_financial_data)
[0m20:50:25.638244 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.cleaned_financial_data
[0m20:50:25.646720 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.cleaned_financial_data"
[0m20:50:25.651919 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.cleaned_financial_data
[0m20:50:25.709839 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.cleaned_financial_data"
[0m20:50:25.715065 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:50:25.715948 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: BEGIN
[0m20:50:25.716807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:50:25.719954 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:50:25.720921 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:50:25.721768 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      
  
    

  create  table "*****"."public_silver"."cleaned_financial_data"
  
  
    as
  
  (
    -- Modelo da camada Silver
with raw_data as (
    select
        *,
        cast(price as numeric(10, 2)) as price_numeric,
        cast(date as date) as transaction_date
    from public.bronze_financial_data
),
cleaned_data as (
    select
        ticker,
        price_numeric as price,
        transaction_date as date
    from raw_data
    where price_numeric > 0  -- Exclui valores de preço inválidos
)

select
    *
from cleaned_data
  );
  
  
[0m20:50:25.738627 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.016 seconds
[0m20:50:25.757208 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m20:50:25.758571 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:50:25.759504 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m20:50:25.761310 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:50:25.763510 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: Close
[0m20:50:25.765394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fed54-da26-4c62-845f-af75930b4420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3205f9ee0>]}
[0m20:50:25.766430 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public_silver.cleaned_financial_data ... [[32mSELECT 7[0m in 0.13s]
[0m20:50:25.767787 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m20:50:25.769641 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:25.770598 [debug] [MainThread]: On master: BEGIN
[0m20:50:25.771345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:25.774305 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:50:25.775288 [debug] [MainThread]: On master: COMMIT
[0m20:50:25.776320 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:25.777359 [debug] [MainThread]: On master: COMMIT
[0m20:50:25.778358 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:25.779240 [debug] [MainThread]: On master: Close
[0m20:50:25.780375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:25.781403 [debug] [MainThread]: Connection 'model.financial_data_pipeline.cleaned_financial_data' was properly closed.
[0m20:50:25.782223 [info ] [MainThread]: 
[0m20:50:25.783263 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m20:50:25.784723 [debug] [MainThread]: Command end result
[0m20:50:25.827245 [info ] [MainThread]: 
[0m20:50:25.828546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:50:25.829571 [info ] [MainThread]: 
[0m20:50:25.830856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:50:25.832675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2665104, "process_user_time": 1.985893, "process_kernel_time": 0.059876, "process_mem_max_rss": "108172", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:50:25.834197 [debug] [MainThread]: Command `dbt run` succeeded at 20:50:25.834026 after 1.27 seconds
[0m20:50:25.835144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3254b8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe323e03400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3237d1850>]}
[0m20:50:25.836030 [debug] [MainThread]: Flushing usage events
[0m20:50:35.231562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e69720a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e4c205b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e4c20550>]}


============================== 20:50:35.237451 | e78bd164-516a-4cd3-aa14-b4662dd01251 ==============================
[0m20:50:35.237451 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:50:35.238996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/*****/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select gold', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:35.380716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e78bd164-516a-4cd3-aa14-b4662dd01251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e6586c10>]}
[0m20:50:35.435776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e78bd164-516a-4cd3-aa14-b4662dd01251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e426e670>]}
[0m20:50:35.437302 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:50:35.505555 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:50:35.698481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:35.699299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:35.734978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e78bd164-516a-4cd3-aa14-b4662dd01251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e3e53130>]}
[0m20:50:35.837466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e78bd164-516a-4cd3-aa14-b4662dd01251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e4255be0>]}
[0m20:50:35.838886 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:50:35.840320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e78bd164-516a-4cd3-aa14-b4662dd01251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e402a610>]}
[0m20:50:35.842134 [info ] [MainThread]: 
[0m20:50:35.843574 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:35.846681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:50:35.901489 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:50:35.902867 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:50:35.903657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:35.907386 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m20:50:35.909009 [debug] [ThreadPool]: On list_*****: Close
[0m20:50:35.910763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_bronze)
[0m20:50:35.917065 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:50:35.917911 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:50:35.918711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:35.921389 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:50:35.922116 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:50:35.922885 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:50:35.925054 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:50:35.926527 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:50:35.927898 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:50:35.928937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_gold)
[0m20:50:35.931500 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:50:35.932352 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:50:35.933111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:35.935749 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:50:35.936720 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:50:35.937510 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:50:35.939619 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:50:35.941110 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:50:35.941939 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:50:35.942952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_silver)
[0m20:50:35.945775 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:50:35.946539 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:50:35.947443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:35.950153 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:50:35.950987 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:50:35.951826 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:50:35.953986 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:50:35.955503 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:50:35.956350 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:50:35.961085 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:35.961902 [debug] [MainThread]: On master: BEGIN
[0m20:50:35.962663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:35.965353 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:50:35.966125 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:35.966919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:35.971578 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:50:35.973054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e78bd164-516a-4cd3-aa14-b4662dd01251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e3553730>]}
[0m20:50:35.973925 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:35.974802 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:35.975783 [debug] [MainThread]: On master: BEGIN
[0m20:50:35.977272 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:50:35.978216 [debug] [MainThread]: On master: COMMIT
[0m20:50:35.979081 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:35.980484 [debug] [MainThread]: On master: COMMIT
[0m20:50:35.982392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:35.983455 [debug] [MainThread]: On master: Close
[0m20:50:35.985158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:35.986180 [info ] [MainThread]: 
[0m20:50:35.994733 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m20:50:35.996322 [info ] [Thread-1  ]: 1 of 1 START sql table model public_gold.aggregated_financial_data ............. [RUN]
[0m20:50:35.997701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_silver, now model.financial_data_pipeline.aggregated_financial_data)
[0m20:50:35.998712 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.aggregated_financial_data
[0m20:50:36.008323 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:50:36.016207 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.aggregated_financial_data
[0m20:50:36.058182 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:50:36.066417 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:50:36.067349 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: BEGIN
[0m20:50:36.068229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:50:36.071057 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:50:36.072028 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:50:36.073033 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */

  
    

  create  table "*****"."public_gold"."aggregated_financial_data__dbt_tmp"
  
  
    as
  
  (
    -- Modelo da camada Gold
with daily_aggregates as (
    select
        date as transaction_date,
        avg(price) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        count(ticker) as total_transactions
    from public.cleaned_financial_data
    group by date
)

select
    *
from daily_aggregates
order by transaction_date
  );
  
[0m20:50:36.074269 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.cleaned_financial_data" does not exist
LINE 20:     from public.cleaned_financial_data
                  ^

[0m20:50:36.075392 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: ROLLBACK
[0m20:50:36.076505 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: Close
[0m20:50:36.078201 [debug] [Thread-1  ]: Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:50:36.079948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e78bd164-516a-4cd3-aa14-b4662dd01251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e52bd250>]}
[0m20:50:36.081126 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_gold.aggregated_financial_data .... [[31mERROR[0m in 0.08s]
[0m20:50:36.082241 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m20:50:36.083871 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:36.084657 [debug] [MainThread]: On master: BEGIN
[0m20:50:36.085338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:36.087887 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:50:36.088668 [debug] [MainThread]: On master: COMMIT
[0m20:50:36.089457 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:36.090299 [debug] [MainThread]: On master: COMMIT
[0m20:50:36.091394 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:36.092221 [debug] [MainThread]: On master: Close
[0m20:50:36.093327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:36.094351 [debug] [MainThread]: Connection 'model.financial_data_pipeline.aggregated_financial_data' was properly closed.
[0m20:50:36.095165 [info ] [MainThread]: 
[0m20:50:36.096268 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m20:50:36.097811 [debug] [MainThread]: Command end result
[0m20:50:36.139371 [info ] [MainThread]: 
[0m20:50:36.140909 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:50:36.142243 [info ] [MainThread]: 
[0m20:50:36.143289 [error] [MainThread]:   Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:50:36.144368 [info ] [MainThread]: 
[0m20:50:36.145463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:50:36.146975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.96884483, "process_user_time": 1.662936, "process_kernel_time": 0.099577, "process_mem_max_rss": "102784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:50:36.148243 [debug] [MainThread]: Command `dbt run` failed at 20:50:36.148004 after 0.97 seconds
[0m20:50:36.149106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e69720a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e6586c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e3f0fd90>]}
[0m20:50:36.149870 [debug] [MainThread]: Flushing usage events
[0m20:51:34.224649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1428ecffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427187490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427187430>]}


============================== 20:51:34.229938 | 954018bd-0b53-4ef4-b01c-371e3159f93f ==============================
[0m20:51:34.229938 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:51:34.231539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'profiles_dir': '/usr/local/*****/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select gold', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:34.377389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954018bd-0b53-4ef4-b01c-371e3159f93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1428aec490>]}
[0m20:51:34.427954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954018bd-0b53-4ef4-b01c-371e3159f93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14272a5f70>]}
[0m20:51:34.429326 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:51:34.489491 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:51:34.665533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:34.666441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:34.699635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954018bd-0b53-4ef4-b01c-371e3159f93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14263ba130>]}
[0m20:51:34.805159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954018bd-0b53-4ef4-b01c-371e3159f93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1428981670>]}
[0m20:51:34.806541 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:51:34.807801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954018bd-0b53-4ef4-b01c-371e3159f93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1428981f40>]}
[0m20:51:34.809623 [info ] [MainThread]: 
[0m20:51:34.811026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:34.812813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:51:34.867837 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:51:34.869069 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:51:34.869985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:34.873435 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m20:51:34.875056 [debug] [ThreadPool]: On list_*****: Close
[0m20:51:34.876836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_gold)
[0m20:51:34.883098 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:51:34.883942 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:51:34.884830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:34.887440 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:51:34.888176 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:51:34.888990 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:51:34.891151 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:51:34.892597 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:51:34.893430 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:51:34.894580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_silver)
[0m20:51:34.897042 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:51:34.897825 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:51:34.898555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:34.901404 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:51:34.902476 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:51:34.903389 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:51:34.906126 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:51:34.907831 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:51:34.908699 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:51:34.909786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_bronze)
[0m20:51:34.912353 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:51:34.913112 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:51:34.913877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:34.916442 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:51:34.918236 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:51:34.920103 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:51:34.922372 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:51:34.923813 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:51:34.924666 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:51:34.929366 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:34.930191 [debug] [MainThread]: On master: BEGIN
[0m20:51:34.930947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:34.933697 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:51:34.934482 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:34.935306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:34.939783 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:51:34.941309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954018bd-0b53-4ef4-b01c-371e3159f93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14263119d0>]}
[0m20:51:34.942325 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:34.943238 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:34.944090 [debug] [MainThread]: On master: BEGIN
[0m20:51:34.945122 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:51:34.946081 [debug] [MainThread]: On master: COMMIT
[0m20:51:34.947006 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:34.947860 [debug] [MainThread]: On master: COMMIT
[0m20:51:34.948897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:34.949905 [debug] [MainThread]: On master: Close
[0m20:51:34.950859 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:34.951871 [info ] [MainThread]: 
[0m20:51:34.959021 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m20:51:34.960138 [info ] [Thread-1  ]: 1 of 1 START sql table model public_gold.aggregated_financial_data ............. [RUN]
[0m20:51:34.961261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now model.financial_data_pipeline.aggregated_financial_data)
[0m20:51:34.962329 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.aggregated_financial_data
[0m20:51:34.970684 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:51:34.977419 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.aggregated_financial_data
[0m20:51:35.018323 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:51:35.024061 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:51:35.024888 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: BEGIN
[0m20:51:35.025668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:35.028439 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:51:35.029242 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:51:35.030034 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */

  
    

  create  table "*****"."public_gold"."aggregated_financial_data__dbt_tmp"
  
  
    as
  
  (
    -- Modelo da camada Gold
with daily_aggregates as (
    select
        date as transaction_date,
        avg(price) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        count(ticker) as total_transactions
    from public.cleaned_financial_data
    group by date
)

select
    *
from daily_aggregates
order by transaction_date
  );
  
[0m20:51:35.031065 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.cleaned_financial_data" does not exist
LINE 20:     from public.cleaned_financial_data
                  ^

[0m20:51:35.031845 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: ROLLBACK
[0m20:51:35.032820 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: Close
[0m20:51:35.034782 [debug] [Thread-1  ]: Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:51:35.036534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '954018bd-0b53-4ef4-b01c-371e3159f93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1428981f40>]}
[0m20:51:35.037749 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_gold.aggregated_financial_data .... [[31mERROR[0m in 0.07s]
[0m20:51:35.039069 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m20:51:35.040963 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:35.041776 [debug] [MainThread]: On master: BEGIN
[0m20:51:35.042509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:35.045686 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:51:35.047388 [debug] [MainThread]: On master: COMMIT
[0m20:51:35.048190 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:35.048894 [debug] [MainThread]: On master: COMMIT
[0m20:51:35.049740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:35.050427 [debug] [MainThread]: On master: Close
[0m20:51:35.051212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:35.051938 [debug] [MainThread]: Connection 'model.financial_data_pipeline.aggregated_financial_data' was properly closed.
[0m20:51:35.052657 [info ] [MainThread]: 
[0m20:51:35.053506 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m20:51:35.054865 [debug] [MainThread]: Command end result
[0m20:51:35.093919 [info ] [MainThread]: 
[0m20:51:35.095188 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:51:35.096262 [info ] [MainThread]: 
[0m20:51:35.097331 [error] [MainThread]:   Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:51:35.098309 [info ] [MainThread]: 
[0m20:51:35.099304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:51:35.100770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9306371, "process_user_time": 1.703725, "process_kernel_time": 0.060847, "process_mem_max_rss": "104072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:51:35.102323 [debug] [MainThread]: Command `dbt run` failed at 20:51:35.102206 after 0.93 seconds
[0m20:51:35.103703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1428ecffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14289cc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142576dbb0>]}
[0m20:51:35.104867 [debug] [MainThread]: Flushing usage events
[0m20:52:08.160438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dd278070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55db526610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55db5265b0>]}


============================== 20:52:08.165717 | afe9bfb6-6744-42ac-8fff-08a069e3af05 ==============================
[0m20:52:08.165717 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:52:08.167320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select gold', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:52:08.312133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afe9bfb6-6744-42ac-8fff-08a069e3af05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dce8c430>]}
[0m20:52:08.364133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afe9bfb6-6744-42ac-8fff-08a069e3af05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dc1a19d0>]}
[0m20:52:08.365710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:52:08.424429 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:52:08.628791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:08.629783 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/bronze/financial_data.sql
[0m20:52:08.842111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afe9bfb6-6744-42ac-8fff-08a069e3af05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d8de5130>]}
[0m20:52:08.968671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afe9bfb6-6744-42ac-8fff-08a069e3af05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55da6f3730>]}
[0m20:52:08.969856 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:52:08.971099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afe9bfb6-6744-42ac-8fff-08a069e3af05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d8dca280>]}
[0m20:52:08.972997 [info ] [MainThread]: 
[0m20:52:08.974429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:08.976188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:52:09.003452 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:52:09.004713 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:52:09.005520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:09.009139 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m20:52:09.010921 [debug] [ThreadPool]: On list_*****: Close
[0m20:52:09.012761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_gold)
[0m20:52:09.018931 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:09.020009 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:52:09.020791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:09.023505 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:09.024312 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:09.025098 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:52:09.027383 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:52:09.028801 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:52:09.029643 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:52:09.030650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_bronze)
[0m20:52:09.033197 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:09.033950 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:52:09.034736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:09.037826 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:09.039753 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:09.040514 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:52:09.042624 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:52:09.044144 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:52:09.044917 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:52:09.046021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_silver)
[0m20:52:09.048685 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:09.049431 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:52:09.050164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:09.052843 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:09.053626 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:09.054408 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:52:09.056540 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:52:09.057996 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:52:09.058829 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:52:09.063935 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:09.064810 [debug] [MainThread]: On master: BEGIN
[0m20:52:09.065580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:09.068335 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:52:09.069048 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:09.069833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:09.074238 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:52:09.075633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afe9bfb6-6744-42ac-8fff-08a069e3af05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55da75fc10>]}
[0m20:52:09.076473 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:09.077275 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:09.078073 [debug] [MainThread]: On master: BEGIN
[0m20:52:09.079046 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:52:09.079791 [debug] [MainThread]: On master: COMMIT
[0m20:52:09.080540 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:09.081301 [debug] [MainThread]: On master: COMMIT
[0m20:52:09.082046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:09.082818 [debug] [MainThread]: On master: Close
[0m20:52:09.083758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:09.084839 [info ] [MainThread]: 
[0m20:52:09.091200 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:09.092221 [info ] [Thread-1  ]: 1 of 1 START sql table model public_gold.aggregated_financial_data ............. [RUN]
[0m20:52:09.093331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_silver, now model.financial_data_pipeline.aggregated_financial_data)
[0m20:52:09.094400 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:09.103346 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:09.109113 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:09.148344 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:09.154068 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:09.154830 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: BEGIN
[0m20:52:09.155617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:09.158520 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:52:09.159292 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:09.160119 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */

  
    

  create  table "*****"."public_gold"."aggregated_financial_data__dbt_tmp"
  
  
    as
  
  (
    -- Modelo da camada Gold
with daily_aggregates as (
    select
        date as transaction_date,
        avg(price) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        count(ticker) as total_transactions
    from public.cleaned_financial_data
    group by date
)

select
    *
from daily_aggregates
order by transaction_date
  );
  
[0m20:52:09.161156 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.cleaned_financial_data" does not exist
LINE 20:     from public.cleaned_financial_data
                  ^

[0m20:52:09.161958 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: ROLLBACK
[0m20:52:09.162895 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: Close
[0m20:52:09.164608 [debug] [Thread-1  ]: Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:52:09.166491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe9bfb6-6744-42ac-8fff-08a069e3af05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dd2eb220>]}
[0m20:52:09.167516 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_gold.aggregated_financial_data .... [[31mERROR[0m in 0.07s]
[0m20:52:09.169267 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:09.171405 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:09.172612 [debug] [MainThread]: On master: BEGIN
[0m20:52:09.173452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:09.176501 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:52:09.177745 [debug] [MainThread]: On master: COMMIT
[0m20:52:09.178708 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:09.179625 [debug] [MainThread]: On master: COMMIT
[0m20:52:09.180648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:09.181589 [debug] [MainThread]: On master: Close
[0m20:52:09.182736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:09.183733 [debug] [MainThread]: Connection 'model.financial_data_pipeline.aggregated_financial_data' was properly closed.
[0m20:52:09.184691 [info ] [MainThread]: 
[0m20:52:09.185920 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:52:09.187482 [debug] [MainThread]: Command end result
[0m20:52:09.231056 [info ] [MainThread]: 
[0m20:52:09.232086 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:52:09.233051 [info ] [MainThread]: 
[0m20:52:09.234307 [error] [MainThread]:   Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:52:09.235344 [info ] [MainThread]: 
[0m20:52:09.236502 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:52:09.238068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1331506, "process_user_time": 1.854513, "process_kernel_time": 0.096589, "process_mem_max_rss": "106744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:52:09.239109 [debug] [MainThread]: Command `dbt run` failed at 20:52:09.239003 after 1.13 seconds
[0m20:52:09.240046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dd278070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dce8c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dc1a19d0>]}
[0m20:52:09.240918 [debug] [MainThread]: Flushing usage events
[0m20:52:28.755363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae03c06040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae01eb4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae01eb4520>]}


============================== 20:52:28.760868 | f626a6e3-c7ef-4b13-aade-b8a90f407679 ==============================
[0m20:52:28.760868 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:52:28.761917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select bronze', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:28.909385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f626a6e3-c7ef-4b13-aade-b8a90f407679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0381a2b0>]}
[0m20:52:28.955123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f626a6e3-c7ef-4b13-aade-b8a90f407679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae015406a0>]}
[0m20:52:28.956671 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:52:29.020466 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:52:29.216515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:29.217274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:29.254247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f626a6e3-c7ef-4b13-aade-b8a90f407679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae010e6130>]}
[0m20:52:29.362119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f626a6e3-c7ef-4b13-aade-b8a90f407679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae036edca0>]}
[0m20:52:29.363338 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:52:29.364711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f626a6e3-c7ef-4b13-aade-b8a90f407679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae036d40a0>]}
[0m20:52:29.366560 [info ] [MainThread]: 
[0m20:52:29.368230 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:29.369803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:52:29.427331 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:52:29.428307 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:52:29.429145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:29.432726 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m20:52:29.434442 [debug] [ThreadPool]: On list_*****: Close
[0m20:52:29.436113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_silver)
[0m20:52:29.442953 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:29.443860 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:52:29.444650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:29.449065 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:52:29.450064 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:29.450843 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:52:29.453078 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:52:29.454635 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:52:29.455493 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:52:29.456517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_bronze)
[0m20:52:29.459366 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:29.460281 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:52:29.461108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:29.463833 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:29.464751 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:29.465565 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:52:29.467789 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:52:29.469324 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:52:29.470402 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:52:29.471706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_gold)
[0m20:52:29.474386 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:29.475168 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:52:29.475880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:29.478509 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:29.479263 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:29.480053 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:52:29.482352 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:52:29.483786 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:52:29.484632 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:52:29.489402 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:29.490261 [debug] [MainThread]: On master: BEGIN
[0m20:52:29.490997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:29.493452 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:52:29.494186 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:29.494926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:29.499510 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:52:29.501034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f626a6e3-c7ef-4b13-aade-b8a90f407679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0103f9d0>]}
[0m20:52:29.501854 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:29.502645 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:29.503407 [debug] [MainThread]: On master: BEGIN
[0m20:52:29.504287 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:52:29.505011 [debug] [MainThread]: On master: COMMIT
[0m20:52:29.505745 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:29.506759 [debug] [MainThread]: On master: COMMIT
[0m20:52:29.507593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:29.508301 [debug] [MainThread]: On master: Close
[0m20:52:29.509155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:29.510128 [info ] [MainThread]: 
[0m20:52:29.521421 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.financial_data
[0m20:52:29.522683 [info ] [Thread-1  ]: 1 of 1 START sql table model public_bronze.financial_data ...................... [RUN]
[0m20:52:29.523936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_gold, now model.financial_data_pipeline.financial_data)
[0m20:52:29.524958 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.financial_data
[0m20:52:29.534181 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.financial_data"
[0m20:52:29.540750 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.financial_data
[0m20:52:29.581930 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.financial_data"
[0m20:52:29.587785 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m20:52:29.588692 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: BEGIN
[0m20:52:29.589573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:29.592564 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:52:29.593461 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m20:52:29.594269 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.financial_data"} */

  
    

  create  table "*****"."public_bronze"."financial_data__dbt_tmp"
  
  
    as
  
  (
    -- Modelo Bronze
select
    *
from public.bronze_financial_data
  );
  
[0m20:52:29.598050 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.003 seconds
[0m20:52:29.604782 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m20:52:29.605726 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.financial_data"} */
alter table "*****"."public_bronze"."financial_data__dbt_tmp" rename to "financial_data"
[0m20:52:29.608011 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:52:29.624384 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: COMMIT
[0m20:52:29.625315 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m20:52:29.626143 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: COMMIT
[0m20:52:29.628208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:52:29.634187 [debug] [Thread-1  ]: Applying DROP to: "*****"."public_bronze"."financial_data__dbt_backup"
[0m20:52:29.639489 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.financial_data"
[0m20:52:29.640700 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.financial_data"} */
drop table if exists "*****"."public_bronze"."financial_data__dbt_backup" cascade
[0m20:52:29.642179 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:52:29.645175 [debug] [Thread-1  ]: On model.financial_data_pipeline.financial_data: Close
[0m20:52:29.647057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f626a6e3-c7ef-4b13-aade-b8a90f407679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae036d40a0>]}
[0m20:52:29.648147 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_bronze.financial_data ................. [[32mSELECT 7[0m in 0.12s]
[0m20:52:29.649506 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.financial_data
[0m20:52:29.651340 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:29.652326 [debug] [MainThread]: On master: BEGIN
[0m20:52:29.653211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:29.656348 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:52:29.657247 [debug] [MainThread]: On master: COMMIT
[0m20:52:29.658003 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:29.658950 [debug] [MainThread]: On master: COMMIT
[0m20:52:29.660181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:29.661157 [debug] [MainThread]: On master: Close
[0m20:52:29.662732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:29.664492 [debug] [MainThread]: Connection 'model.financial_data_pipeline.financial_data' was properly closed.
[0m20:52:29.667829 [info ] [MainThread]: 
[0m20:52:29.669392 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:52:29.671189 [debug] [MainThread]: Command end result
[0m20:52:29.718486 [info ] [MainThread]: 
[0m20:52:29.719598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:29.720696 [info ] [MainThread]: 
[0m20:52:29.722691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:52:29.724006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0221996, "process_user_time": 1.773166, "process_kernel_time": 0.040998, "process_mem_max_rss": "106092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:52:29.725060 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:29.724929 after 1.02 seconds
[0m20:52:29.725933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae03c06040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae036c2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae010949d0>]}
[0m20:52:29.726685 [debug] [MainThread]: Flushing usage events
[0m20:52:35.969190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128314fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41265cc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41265cc430>]}


============================== 20:52:35.975058 | 3e833c64-710a-4f8d-8919-026bf9b5193c ==============================
[0m20:52:35.975058 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:52:35.976897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/*****/dbt', 'log_path': '/usr/local/*****/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select silver', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:36.124572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e833c64-710a-4f8d-8919-026bf9b5193c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4127f32490>]}
[0m20:52:36.169398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e833c64-710a-4f8d-8919-026bf9b5193c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41266ebf70>]}
[0m20:52:36.170909 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:52:36.230094 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:52:36.425653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:36.426556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:36.467187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e833c64-710a-4f8d-8919-026bf9b5193c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41257fd130>]}
[0m20:52:36.578865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e833c64-710a-4f8d-8919-026bf9b5193c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4125b11700>]}
[0m20:52:36.580101 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:52:36.581422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e833c64-710a-4f8d-8919-026bf9b5193c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4125815c10>]}
[0m20:52:36.583315 [info ] [MainThread]: 
[0m20:52:36.584611 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:36.586130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:52:36.651922 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:52:36.653377 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:52:36.654230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:36.657967 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m20:52:36.659740 [debug] [ThreadPool]: On list_*****: Close
[0m20:52:36.661686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_silver)
[0m20:52:36.667950 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:36.668788 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:52:36.669604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:36.672396 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:36.673155 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:36.674028 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:52:36.676506 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m20:52:36.678183 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:52:36.679180 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:52:36.680302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_bronze)
[0m20:52:36.683186 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:36.684026 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:52:36.684761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:36.687640 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:36.688487 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:36.689254 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:52:36.691516 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:52:36.693127 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:52:36.694130 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:52:36.695276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_gold)
[0m20:52:36.698042 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:36.699051 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:52:36.700102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:36.702847 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:36.703777 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:36.704596 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:52:36.706808 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:52:36.708481 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:52:36.709380 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:52:36.714388 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:36.715213 [debug] [MainThread]: On master: BEGIN
[0m20:52:36.716041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:36.718666 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:52:36.719515 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:36.720402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:36.725386 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:52:36.726792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e833c64-710a-4f8d-8919-026bf9b5193c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41257ab550>]}
[0m20:52:36.727651 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:36.728461 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:36.729222 [debug] [MainThread]: On master: BEGIN
[0m20:52:36.730253 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:52:36.730995 [debug] [MainThread]: On master: COMMIT
[0m20:52:36.731716 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:36.732390 [debug] [MainThread]: On master: COMMIT
[0m20:52:36.733235 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:36.733926 [debug] [MainThread]: On master: Close
[0m20:52:36.735096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:36.736542 [info ] [MainThread]: 
[0m20:52:36.746176 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m20:52:36.747243 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public_silver.cleaned_financial_data ........ [RUN]
[0m20:52:36.748454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_gold, now model.financial_data_pipeline.cleaned_financial_data)
[0m20:52:36.749431 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.cleaned_financial_data
[0m20:52:36.758410 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.765013 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.cleaned_financial_data
[0m20:52:36.820704 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.821935 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

    
  
    

  create temporary table "cleaned_financial_data__dbt_tmp205236796613"
  
  
    as
  
  (
    -- Modelo da camada Silver
with raw_data as (
    select
        *,
        cast(price as numeric(10, 2)) as price_numeric,
        cast(date as date) as transaction_date
    from public.bronze_financial_data
),
cleaned_data as (
    select
        ticker,
        price_numeric as price,
        transaction_date as date
    from raw_data
    where price_numeric > 0  -- Exclui valores de preço inválidos
)

select
    *
from cleaned_data
  );
  
  
[0m20:52:36.822844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:36.827228 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.004 seconds
[0m20:52:36.840967 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.842225 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: BEGIN
[0m20:52:36.843593 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m20:52:36.844405 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.845235 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'cleaned_financial_data__dbt_tmp205236796613'
        
      order by ordinal_position

  
[0m20:52:36.852263 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.006 seconds
[0m20:52:36.858159 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.859071 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "*****".INFORMATION_SCHEMA.columns
      where table_name = 'cleaned_financial_data'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m20:52:36.861500 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.002 seconds
[0m20:52:36.876149 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.877086 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "*****".INFORMATION_SCHEMA.columns
      where table_name = 'cleaned_financial_data'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m20:52:36.879549 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.001 seconds
[0m20:52:36.890390 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.896438 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.897435 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      insert into "*****"."public_silver"."cleaned_financial_data" ("ticker", "price", "date")
    (
        select "ticker", "price", "date"
        from "cleaned_financial_data__dbt_tmp205236796613"
    )


  
[0m20:52:36.898779 [debug] [Thread-1  ]: SQL status: INSERT 0 7 in 0.000 seconds
[0m20:52:36.912790 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m20:52:36.913866 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m20:52:36.914898 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m20:52:36.916462 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:52:36.918604 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: Close
[0m20:52:36.920692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e833c64-710a-4f8d-8919-026bf9b5193c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4127f8a820>]}
[0m20:52:36.921932 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public_silver.cleaned_financial_data ... [[32mINSERT 0 7[0m in 0.17s]
[0m20:52:36.923241 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m20:52:36.925071 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:36.926158 [debug] [MainThread]: On master: BEGIN
[0m20:52:36.927274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:36.930353 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:52:36.931291 [debug] [MainThread]: On master: COMMIT
[0m20:52:36.932542 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:36.933967 [debug] [MainThread]: On master: COMMIT
[0m20:52:36.935843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:36.936681 [debug] [MainThread]: On master: Close
[0m20:52:36.937553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:36.938455 [debug] [MainThread]: Connection 'model.financial_data_pipeline.cleaned_financial_data' was properly closed.
[0m20:52:36.939245 [info ] [MainThread]: 
[0m20:52:36.940302 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m20:52:36.941821 [debug] [MainThread]: Command end result
[0m20:52:36.982825 [info ] [MainThread]: 
[0m20:52:36.984256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:36.985267 [info ] [MainThread]: 
[0m20:52:36.986256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:52:36.987827 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0762742, "process_user_time": 1.790432, "process_kernel_time": 0.079574, "process_mem_max_rss": "104568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:52:36.989072 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:36.988953 after 1.08 seconds
[0m20:52:36.990051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4128314fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4125b795e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4125a11d90>]}
[0m20:52:36.991019 [debug] [MainThread]: Flushing usage events
[0m20:52:40.979096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a0856040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59eb04550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59eb044f0>]}


============================== 20:52:40.984784 | 7d82d63f-8184-49b8-8fb4-f3862ec5c049 ==============================
[0m20:52:40.984784 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:52:40.986587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select gold', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:41.131798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d82d63f-8184-49b8-8fb4-f3862ec5c049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59eb1eb80>]}
[0m20:52:41.180828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d82d63f-8184-49b8-8fb4-f3862ec5c049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59eb1e0a0>]}
[0m20:52:41.182252 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:52:41.240257 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:52:41.438716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:41.439805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:41.473067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d82d63f-8184-49b8-8fb4-f3862ec5c049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59dd36130>]}
[0m20:52:41.577312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d82d63f-8184-49b8-8fb4-f3862ec5c049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59dd4de50>]}
[0m20:52:41.578254 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:52:41.579228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d82d63f-8184-49b8-8fb4-f3862ec5c049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59deb6970>]}
[0m20:52:41.580945 [info ] [MainThread]: 
[0m20:52:41.582372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:41.583742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:52:41.641562 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:52:41.642718 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:52:41.643684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:41.647483 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m20:52:41.649021 [debug] [ThreadPool]: On list_*****: Close
[0m20:52:41.650752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_silver)
[0m20:52:41.656845 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:41.657685 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:52:41.658457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:41.661086 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:41.661870 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:52:41.662640 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:52:41.664818 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:52:41.666284 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:52:41.667105 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:52:41.668096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_gold)
[0m20:52:41.670790 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:41.672135 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:52:41.673616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:41.678176 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m20:52:41.679295 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:52:41.680267 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:52:41.682429 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:52:41.683978 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:52:41.684923 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:52:41.685941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_bronze)
[0m20:52:41.688944 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:41.689734 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:52:41.690480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:41.693092 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:41.693869 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:52:41.694669 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:52:41.696826 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:52:41.698350 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:52:41.699255 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:52:41.704596 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:41.705476 [debug] [MainThread]: On master: BEGIN
[0m20:52:41.706421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:41.709752 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:52:41.710648 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:41.711488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:41.716902 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:52:41.718480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d82d63f-8184-49b8-8fb4-f3862ec5c049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a033f490>]}
[0m20:52:41.719409 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:41.720371 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:41.721137 [debug] [MainThread]: On master: BEGIN
[0m20:52:41.722236 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:52:41.723102 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.723868 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:41.724605 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.725408 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:41.726191 [debug] [MainThread]: On master: Close
[0m20:52:41.727094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:41.728417 [info ] [MainThread]: 
[0m20:52:41.736807 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:41.738202 [info ] [Thread-1  ]: 1 of 1 START sql table model public_gold.aggregated_financial_data ............. [RUN]
[0m20:52:41.739493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now model.financial_data_pipeline.aggregated_financial_data)
[0m20:52:41.740560 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:41.748449 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:41.754027 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:41.794149 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:41.800276 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:41.802255 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: BEGIN
[0m20:52:41.803146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:41.806265 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:52:41.807093 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:52:41.807941 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */

  
    

  create  table "*****"."public_gold"."aggregated_financial_data__dbt_tmp"
  
  
    as
  
  (
    -- Modelo da camada Gold
with daily_aggregates as (
    select
        date as transaction_date,
        avg(price) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        count(ticker) as total_transactions
    from public.cleaned_financial_data
    group by date
)

select
    *
from daily_aggregates
order by transaction_date
  );
  
[0m20:52:41.809178 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.cleaned_financial_data" does not exist
LINE 20:     from public.cleaned_financial_data
                  ^

[0m20:52:41.809967 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: ROLLBACK
[0m20:52:41.810980 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: Close
[0m20:52:41.812793 [debug] [Thread-1  ]: Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:52:41.814530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d82d63f-8184-49b8-8fb4-f3862ec5c049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59eae7df0>]}
[0m20:52:41.815532 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_gold.aggregated_financial_data .... [[31mERROR[0m in 0.07s]
[0m20:52:41.816669 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m20:52:41.818405 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:41.819173 [debug] [MainThread]: On master: BEGIN
[0m20:52:41.819922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:41.822658 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:52:41.823508 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.824412 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:41.825237 [debug] [MainThread]: On master: COMMIT
[0m20:52:41.826339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:41.827349 [debug] [MainThread]: On master: Close
[0m20:52:41.828390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:41.829317 [debug] [MainThread]: Connection 'model.financial_data_pipeline.aggregated_financial_data' was properly closed.
[0m20:52:41.830298 [info ] [MainThread]: 
[0m20:52:41.831342 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m20:52:41.832665 [debug] [MainThread]: Command end result
[0m20:52:41.874399 [info ] [MainThread]: 
[0m20:52:41.875620 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:52:41.876732 [info ] [MainThread]: 
[0m20:52:41.877892 [error] [MainThread]:   Database Error in model aggregated_financial_data (models/gold/aggregated_financial_data.sql)
  relation "public.cleaned_financial_data" does not exist
  LINE 20:     from public.cleaned_financial_data
                    ^
  compiled code at target/run/financial_data_pipeline/models/gold/aggregated_financial_data.sql
[0m20:52:41.879179 [info ] [MainThread]: 
[0m20:52:41.880361 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:52:41.882016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.95787627, "process_user_time": 1.682033, "process_kernel_time": 0.097792, "process_mem_max_rss": "104260", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:52:41.883117 [debug] [MainThread]: Command `dbt run` failed at 20:52:41.882996 after 0.96 seconds
[0m20:52:41.884066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a0856040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59f1a03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59d140b50>]}
[0m20:52:41.884935 [debug] [MainThread]: Flushing usage events
[0m20:52:59.790455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2c938070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2abe6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2abe65b0>]}


============================== 20:52:59.796300 | 7bc1edd7-4c07-40e7-9666-3de3a93675f5 ==============================
[0m20:52:59.796300 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:52:59.797271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select gold', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:59.942368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bc1edd7-4c07-40e7-9666-3de3a93675f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2c54c430>]}
[0m20:52:59.988172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bc1edd7-4c07-40e7-9666-3de3a93675f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2b8619d0>]}
[0m20:52:59.989431 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:53:00.053290 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:53:00.266473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:53:00.267954 [debug] [MainThread]: Partial parsing: updated file: financial_data_pipeline://models/gold/aggregated_financial_data.sql
[0m20:53:00.573035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bc1edd7-4c07-40e7-9666-3de3a93675f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca29f62d00>]}
[0m20:53:00.668830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bc1edd7-4c07-40e7-9666-3de3a93675f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2843dbe0>]}
[0m20:53:00.670257 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m20:53:00.671473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc1edd7-4c07-40e7-9666-3de3a93675f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ac51820>]}
[0m20:53:00.673877 [info ] [MainThread]: 
[0m20:53:00.675663 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:00.677738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m20:53:00.708849 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m20:53:00.710176 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m20:53:00.711161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:00.714653 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m20:53:00.716259 [debug] [ThreadPool]: On list_*****: Close
[0m20:53:00.717925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_bronze)
[0m20:53:00.724240 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:53:00.725253 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m20:53:00.726054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:00.728899 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:53:00.729706 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m20:53:00.730465 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m20:53:00.732581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:53:00.734024 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m20:53:00.734727 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m20:53:00.736257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_silver)
[0m20:53:00.739147 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:53:00.739916 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m20:53:00.740611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:00.743899 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:53:00.744977 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m20:53:00.745642 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m20:53:00.747892 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:53:00.749451 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m20:53:00.750259 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m20:53:00.751190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_gold)
[0m20:53:00.753714 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:53:00.754432 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m20:53:00.755117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:00.757620 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:53:00.758295 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m20:53:00.759031 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m20:53:00.761122 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:53:00.762495 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m20:53:00.763319 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m20:53:00.768280 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:00.769195 [debug] [MainThread]: On master: BEGIN
[0m20:53:00.769941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:00.772600 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:53:00.773360 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:00.774146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:53:00.779377 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:53:00.780935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc1edd7-4c07-40e7-9666-3de3a93675f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca28461c40>]}
[0m20:53:00.782034 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:00.783016 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:00.783810 [debug] [MainThread]: On master: BEGIN
[0m20:53:00.784884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:53:00.785677 [debug] [MainThread]: On master: COMMIT
[0m20:53:00.786457 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:00.787217 [debug] [MainThread]: On master: COMMIT
[0m20:53:00.787998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:53:00.788812 [debug] [MainThread]: On master: Close
[0m20:53:00.789805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:00.790774 [info ] [MainThread]: 
[0m20:53:00.796672 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m20:53:00.798081 [info ] [Thread-1  ]: 1 of 1 START sql table model public_gold.aggregated_financial_data ............. [RUN]
[0m20:53:00.799532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_gold, now model.financial_data_pipeline.aggregated_financial_data)
[0m20:53:00.800734 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.aggregated_financial_data
[0m20:53:00.807825 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:53:00.813456 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.aggregated_financial_data
[0m20:53:00.854231 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.aggregated_financial_data"
[0m20:53:00.859588 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:53:00.860462 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: BEGIN
[0m20:53:00.861271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:53:00.864063 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:53:00.864930 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:53:00.865763 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */

  
    

  create  table "*****"."public_gold"."aggregated_financial_data__dbt_tmp"
  
  
    as
  
  (
    -- Modelo da camada Gold
with daily_aggregates as (
    select
        date as transaction_date,
        avg(price) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        count(ticker) as total_transactions
    from public_silver.cleaned_financial_data
    group by date
)

select
    *
from daily_aggregates
order by transaction_date
  );
  
[0m20:53:00.869807 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.003 seconds
[0m20:53:00.876027 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:53:00.877091 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */
alter table "*****"."public_gold"."aggregated_financial_data__dbt_tmp" rename to "aggregated_financial_data"
[0m20:53:00.878231 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:53:00.894733 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: COMMIT
[0m20:53:00.896086 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:53:00.896960 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: COMMIT
[0m20:53:00.898583 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:53:00.904822 [debug] [Thread-1  ]: Applying DROP to: "*****"."public_gold"."aggregated_financial_data__dbt_backup"
[0m20:53:00.909710 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m20:53:00.910671 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */
drop table if exists "*****"."public_gold"."aggregated_financial_data__dbt_backup" cascade
[0m20:53:00.912135 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:53:00.914774 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: Close
[0m20:53:00.916559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc1edd7-4c07-40e7-9666-3de3a93675f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca281ae8e0>]}
[0m20:53:00.917584 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_gold.aggregated_financial_data ........ [[32mSELECT 3[0m in 0.12s]
[0m20:53:00.919120 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m20:53:00.920814 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:00.921549 [debug] [MainThread]: On master: BEGIN
[0m20:53:00.922329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:00.924965 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:53:00.925721 [debug] [MainThread]: On master: COMMIT
[0m20:53:00.926491 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:00.927682 [debug] [MainThread]: On master: COMMIT
[0m20:53:00.929888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:53:00.931104 [debug] [MainThread]: On master: Close
[0m20:53:00.932460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:00.933590 [debug] [MainThread]: Connection 'model.financial_data_pipeline.aggregated_financial_data' was properly closed.
[0m20:53:00.934437 [info ] [MainThread]: 
[0m20:53:00.935870 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m20:53:00.937370 [debug] [MainThread]: Command end result
[0m20:53:00.977711 [info ] [MainThread]: 
[0m20:53:00.979210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:00.980483 [info ] [MainThread]: 
[0m20:53:00.981671 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:53:00.983245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2486984, "process_user_time": 1.938468, "process_kernel_time": 0.093295, "process_mem_max_rss": "105900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:53:00.984288 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:00.984164 after 1.25 seconds
[0m20:53:00.985294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2c938070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2b2f5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2b8619d0>]}
[0m20:53:00.986295 [debug] [MainThread]: Flushing usage events
[0m20:53:27.132889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3076cabe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074f62310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074f622b0>]}


============================== 20:53:27.140348 | 73da8e96-2316-403b-8347-fc4e8153e0b0 ==============================
[0m20:53:27.140348 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:53:27.141294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:53:27.147891 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m20:53:27.149106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.08183756, "process_user_time": 1.087995, "process_kernel_time": 0.257162, "process_mem_max_rss": "83192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:53:27.150079 [debug] [MainThread]: Command `dbt run` failed at 20:53:27.149967 after 0.08 seconds
[0m20:53:27.150846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3076cabe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074f15fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3074f15310>]}
[0m20:53:27.151537 [debug] [MainThread]: Flushing usage events
[0m20:57:11.198604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c393bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c376742b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c37674250>]}


============================== 20:57:11.204268 | 0ba547a7-3bff-4da1-b915-4f41fec45fa3 ==============================
[0m20:57:11.204268 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:57:11.205412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:57:11.212453 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m20:57:11.213791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07012854, "process_user_time": 1.042592, "process_kernel_time": 0.070174, "process_mem_max_rss": "83088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:57:11.214900 [debug] [MainThread]: Command `dbt run` failed at 20:57:11.214809 after 0.07 seconds
[0m20:57:11.215706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c393bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c376e3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c376e37c0>]}
[0m20:57:11.216483 [debug] [MainThread]: Flushing usage events
[0m20:58:42.002965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa61a2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa4459310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa44592b0>]}


============================== 20:58:42.008506 | 7f0d1daf-7b9c-4cad-8afb-262c6da3a950 ==============================
[0m20:58:42.008506 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:42.009587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:42.016557 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m20:58:42.017783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.06932595, "process_user_time": 1.112896, "process_kernel_time": 0.039394, "process_mem_max_rss": "82904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:42.018740 [debug] [MainThread]: Command `dbt run` failed at 20:58:42.018644 after 0.07 seconds
[0m20:58:42.019530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa61a2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa440cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa440c310>]}
[0m20:58:42.020787 [debug] [MainThread]: Flushing usage events
[0m21:06:29.973531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1293217e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12914ce490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12914ce430>]}


============================== 21:06:29.979709 | f3412519-6df3-41d6-acf6-31748ee971cf ==============================
[0m21:06:29.979709 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:06:29.980745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:06:29.988955 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m21:06:29.990382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07819378, "process_user_time": 1.123746, "process_kernel_time": 0.029572, "process_mem_max_rss": "83316", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:06:29.991366 [debug] [MainThread]: Command `dbt run` failed at 21:06:29.991260 after 0.08 seconds
[0m21:06:29.992125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1293217e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129154df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129154d970>]}
[0m21:06:29.992989 [debug] [MainThread]: Flushing usage events
[0m21:11:32.174420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b79e11df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b780c7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b780c71f0>]}


============================== 21:11:32.179792 | 4430d556-12d7-4f5f-ab4b-e80fbfc15648 ==============================
[0m21:11:32.179792 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:11:32.180693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'send_anonymous_usage_stats': 'True'}
[0m21:11:32.187111 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m21:11:32.188244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.06364944, "process_user_time": 1.014623, "process_kernel_time": 0.059683, "process_mem_max_rss": "82984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:11:32.189334 [debug] [MainThread]: Command `dbt run` failed at 21:11:32.189199 after 0.06 seconds
[0m21:11:32.190412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b79e11df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b78121790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b780d14f0>]}
[0m21:11:32.191206 [debug] [MainThread]: Flushing usage events
[0m21:21:02.715647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1b0f6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1939f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1939f400>]}


============================== 21:21:02.722567 | 6b768f1c-c69a-4f85-8b77-11893b5d804d ==============================
[0m21:21:02.722567 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:21:02.724025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:21:02.738767 [info ] [MainThread]: dbt version: 1.8.0
[0m21:21:02.739929 [info ] [MainThread]: python version: 3.9.14
[0m21:21:02.741042 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:21:02.742179 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m21:21:02.810622 [info ] [MainThread]: Using profiles dir at /usr/local/*****/dbt
[0m21:21:02.811841 [info ] [MainThread]: Using profiles.yml file at /usr/local/*****/dbt/profiles.yml
[0m21:21:02.812847 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/*****/dbt/dbt_project.yml
[0m21:21:02.814415 [info ] [MainThread]: adapter type: postgres
[0m21:21:02.815351 [info ] [MainThread]: adapter version: 1.8.2
[0m21:21:02.900169 [info ] [MainThread]: Configuration:
[0m21:21:02.901299 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:21:02.902342 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:21:02.903334 [info ] [MainThread]: Required dependencies:
[0m21:21:02.904403 [debug] [MainThread]: Executing "git --help"
[0m21:21:02.914982 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:21:02.916181 [debug] [MainThread]: STDERR: "b''"
[0m21:21:02.916960 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:21:02.917939 [info ] [MainThread]: Connection:
[0m21:21:02.918989 [info ] [MainThread]:   host: postgres
[0m21:21:02.919939 [info ] [MainThread]:   port: 5432
[0m21:21:02.921020 [info ] [MainThread]:   user: *****
[0m21:21:02.922008 [info ] [MainThread]:   database: *****
[0m21:21:02.923295 [info ] [MainThread]:   schema: public
[0m21:21:02.924776 [info ] [MainThread]:   connect_timeout: 10
[0m21:21:02.926119 [info ] [MainThread]:   role: None
[0m21:21:02.927481 [info ] [MainThread]:   search_path: None
[0m21:21:02.928404 [info ] [MainThread]:   keepalives_idle: 0
[0m21:21:02.929540 [info ] [MainThread]:   sslmode: None
[0m21:21:02.930600 [info ] [MainThread]:   sslcert: None
[0m21:21:02.931447 [info ] [MainThread]:   sslkey: None
[0m21:21:02.932273 [info ] [MainThread]:   sslrootcert: None
[0m21:21:02.933089 [info ] [MainThread]:   application_name: dbt
[0m21:21:02.933936 [info ] [MainThread]:   retries: 1
[0m21:21:02.935034 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:21:02.991768 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:21:03.012550 [debug] [MainThread]: Using postgres connection "debug"
[0m21:21:03.013616 [debug] [MainThread]: On debug: select 1 as id
[0m21:21:03.014692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:03.019096 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m21:21:03.020931 [debug] [MainThread]: On debug: Close
[0m21:21:03.022356 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:21:03.023665 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:21:03.025824 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3659158, "process_user_time": 1.337222, "process_kernel_time": 0.142257, "process_mem_max_rss": "95032", "process_in_blocks": "44576", "process_out_blocks": "0"}
[0m21:21:03.027151 [debug] [MainThread]: Command `dbt debug` succeeded at 21:21:03.027017 after 0.37 seconds
[0m21:21:03.028032 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:21:03.028962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1b0f6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1a01eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1a6c5d00>]}
[0m21:21:03.029783 [debug] [MainThread]: Flushing usage events
[0m21:29:50.671501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae783aae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae76661490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae76661430>]}


============================== 21:29:50.677083 | 71b65682-368c-4708-a8da-bce694e48aef ==============================
[0m21:29:50.677083 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:50.678054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:29:50.684989 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'financial_data'
[0m21:29:50.686661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07174549, "process_user_time": 1.116393, "process_kernel_time": 0.088136, "process_mem_max_rss": "83236", "process_in_blocks": "19544", "command_success": false, "process_out_blocks": "0"}
[0m21:29:50.687805 [debug] [MainThread]: Command `dbt run` failed at 21:29:50.687690 after 0.07 seconds
[0m21:29:50.688673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae783aae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae76671130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7667f6d0>]}
[0m21:29:50.689519 [debug] [MainThread]: Flushing usage events
[0m21:33:59.704949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b8a3cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b80b09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b6cf4130>]}


============================== 21:33:59.711523 | cc116264-988c-4dbc-be17-42e710c28dc9 ==============================
[0m21:33:59.711523 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:33:59.713051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select silver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:33:59.721148 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m21:33:59.723375 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07321739, "process_user_time": 1.105725, "process_kernel_time": 0.029884, "process_mem_max_rss": "83084", "process_in_blocks": "8", "command_success": false, "process_out_blocks": "0"}
[0m21:33:59.724480 [debug] [MainThread]: Command `dbt run` failed at 21:33:59.724374 after 0.07 seconds
[0m21:33:59.725347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b8a3cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b6d1c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b6d1c3d0>]}
[0m21:33:59.726282 [debug] [MainThread]: Flushing usage events
[0m21:36:02.489470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f53032850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f512e3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f512e3d30>]}


============================== 21:36:02.494748 | a88e4c18-86c3-494c-9106-0230b7ef8abf ==============================
[0m21:36:02.494748 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:36:02.495801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select silver', 'send_anonymous_usage_stats': 'True'}
[0m21:36:02.686896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88e4c18-86c3-494c-9106-0230b7ef8abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f526723a0>]}
[0m21:36:02.739851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88e4c18-86c3-494c-9106-0230b7ef8abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f519fccd0>]}
[0m21:36:02.741462 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:36:02.809035 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:36:03.034312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:03.035223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:03.071822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88e4c18-86c3-494c-9106-0230b7ef8abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5051ae50>]}
[0m21:36:03.192747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88e4c18-86c3-494c-9106-0230b7ef8abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f5049fdf0>]}
[0m21:36:03.193910 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m21:36:03.194989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88e4c18-86c3-494c-9106-0230b7ef8abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f50529d30>]}
[0m21:36:03.196854 [info ] [MainThread]: 
[0m21:36:03.198209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:03.199562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m21:36:03.257066 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m21:36:03.258080 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m21:36:03.258830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:03.262010 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m21:36:03.263408 [debug] [ThreadPool]: On list_*****: Close
[0m21:36:03.265039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now list_*****_public_silver)
[0m21:36:03.271043 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m21:36:03.272197 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m21:36:03.273702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:03.277248 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:36:03.278126 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m21:36:03.278978 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:36:03.283700 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:36:03.285174 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m21:36:03.285964 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m21:36:03.286953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_gold)
[0m21:36:03.289545 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m21:36:03.290357 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m21:36:03.291313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:03.294072 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:36:03.294926 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m21:36:03.295923 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:36:03.298300 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m21:36:03.300110 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m21:36:03.301424 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m21:36:03.302394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_gold, now list_*****_public_bronze)
[0m21:36:03.304847 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m21:36:03.305756 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m21:36:03.306460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:03.309136 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:36:03.309850 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m21:36:03.310452 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:36:03.312403 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m21:36:03.314077 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m21:36:03.314905 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m21:36:03.319784 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:03.320570 [debug] [MainThread]: On master: BEGIN
[0m21:36:03.321240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:03.323982 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:36:03.324746 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:03.325595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:36:03.333915 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m21:36:03.335590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88e4c18-86c3-494c-9106-0230b7ef8abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f52bad580>]}
[0m21:36:03.336496 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:03.337357 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:03.338065 [debug] [MainThread]: On master: BEGIN
[0m21:36:03.339043 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:36:03.339712 [debug] [MainThread]: On master: COMMIT
[0m21:36:03.340336 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:03.340904 [debug] [MainThread]: On master: COMMIT
[0m21:36:03.341619 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:03.342281 [debug] [MainThread]: On master: Close
[0m21:36:03.343087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:36:03.343867 [info ] [MainThread]: 
[0m21:36:03.350615 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m21:36:03.351619 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public_silver.cleaned_financial_data ........ [RUN]
[0m21:36:03.352473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now model.financial_data_pipeline.cleaned_financial_data)
[0m21:36:03.353250 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.cleaned_financial_data
[0m21:36:03.361031 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.365839 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.cleaned_financial_data
[0m21:36:03.423575 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.424866 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

    
  
    

  create temporary table "cleaned_financial_data__dbt_tmp213603396624"
  
  
    as
  
  (
    -- Modelo da camada Silver
with raw_data as (
    select
        *,
        cast(price as numeric(10, 2)) as price_numeric,
        cast(date as date) as transaction_date
    from public.bronze_financial_data
),
cleaned_data as (
    select
        ticker,
        price_numeric as price,
        transaction_date as date
    from raw_data
    where price_numeric > 0  -- Exclui valores de preço inválidos
)

select
    *
from cleaned_data
  );
  
  
[0m21:36:03.425951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:03.430681 [debug] [Thread-1  ]: SQL status: SELECT 21 in 0.005 seconds
[0m21:36:03.445001 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.446114 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: BEGIN
[0m21:36:03.447066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m21:36:03.447725 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.448410 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'cleaned_financial_data__dbt_tmp213603396624'
        
      order by ordinal_position

  
[0m21:36:03.456722 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.008 seconds
[0m21:36:03.465331 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.466425 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "*****".INFORMATION_SCHEMA.columns
      where table_name = 'cleaned_financial_data'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m21:36:03.469048 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.002 seconds
[0m21:36:03.476672 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.477469 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "*****".INFORMATION_SCHEMA.columns
      where table_name = 'cleaned_financial_data'
        
        and table_schema = 'public_silver'
        
      order by ordinal_position

  
[0m21:36:03.479807 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.002 seconds
[0m21:36:03.491059 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.496400 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.497405 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      insert into "*****"."public_silver"."cleaned_financial_data" ("ticker", "price", "date")
    (
        select "ticker", "price", "date"
        from "cleaned_financial_data__dbt_tmp213603396624"
    )


  
[0m21:36:03.499775 [debug] [Thread-1  ]: SQL status: INSERT 0 21 in 0.001 seconds
[0m21:36:03.513889 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m21:36:03.515167 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:36:03.516235 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m21:36:03.518496 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:36:03.520629 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: Close
[0m21:36:03.522388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88e4c18-86c3-494c-9106-0230b7ef8abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f51a96e80>]}
[0m21:36:03.523358 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public_silver.cleaned_financial_data ... [[32mINSERT 0 21[0m in 0.17s]
[0m21:36:03.524299 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m21:36:03.525727 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:03.526795 [debug] [MainThread]: On master: BEGIN
[0m21:36:03.527847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:03.532909 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:36:03.534093 [debug] [MainThread]: On master: COMMIT
[0m21:36:03.534843 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:03.535719 [debug] [MainThread]: On master: COMMIT
[0m21:36:03.536597 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:03.537346 [debug] [MainThread]: On master: Close
[0m21:36:03.538153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:03.538836 [debug] [MainThread]: Connection 'model.financial_data_pipeline.cleaned_financial_data' was properly closed.
[0m21:36:03.539545 [info ] [MainThread]: 
[0m21:36:03.540276 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m21:36:03.541209 [debug] [MainThread]: Command end result
[0m21:36:03.578186 [info ] [MainThread]: 
[0m21:36:03.579099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:03.579895 [info ] [MainThread]: 
[0m21:36:03.580824 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:36:03.581990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.149526, "process_user_time": 1.857608, "process_kernel_time": 0.089884, "process_mem_max_rss": "269116", "process_in_blocks": "4752", "process_out_blocks": "0"}
[0m21:36:03.582772 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:03.582672 after 1.15 seconds
[0m21:36:03.583420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f53032850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f508d9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f505598e0>]}
[0m21:36:03.584118 [debug] [MainThread]: Flushing usage events
[0m21:36:06.442419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bf9dadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bf04c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bdc91130>]}


============================== 21:36:06.448146 | f38d7009-a112-4d45-8e95-02974786e93b ==============================
[0m21:36:06.448146 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:36:06.449123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select gold', 'send_anonymous_usage_stats': 'True'}
[0m21:36:06.456458 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_HOST'
[0m21:36:06.457635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07167565, "process_user_time": 1.066654, "process_kernel_time": 0.069134, "process_mem_max_rss": "83240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:36:06.458732 [debug] [MainThread]: Command `dbt run` failed at 21:36:06.458624 after 0.07 seconds
[0m21:36:06.459534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bf9dadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bdcb9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bdcb93d0>]}
[0m21:36:06.460360 [debug] [MainThread]: Flushing usage events
[0m21:55:30.436489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b8980fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b6c38550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b6c384f0>]}


============================== 21:55:30.442067 | 5c6e3593-2533-409a-9928-e374cdd1cfad ==============================
[0m21:55:30.442067 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:55:30.443545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/*****/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select silver', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:30.593389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c6e3593-2533-409a-9928-e374cdd1cfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b7f59e80>]}
[0m21:55:30.640540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c6e3593-2533-409a-9928-e374cdd1cfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b6224f70>]}
[0m21:55:30.642611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:55:30.709262 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:55:30.941768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:30.942877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:30.982641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c6e3593-2533-409a-9928-e374cdd1cfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b5e6a130>]}
[0m21:55:31.092550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c6e3593-2533-409a-9928-e374cdd1cfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b8432970>]}
[0m21:55:31.093921 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m21:55:31.094881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6e3593-2533-409a-9928-e374cdd1cfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b62895e0>]}
[0m21:55:31.096486 [info ] [MainThread]: 
[0m21:55:31.097594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:31.098904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m21:55:31.154977 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m21:55:31.156165 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m21:55:31.157074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:31.160526 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m21:55:31.162332 [debug] [ThreadPool]: On list_*****: Close
[0m21:55:31.164029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now create_*****_public_silver)
[0m21:55:31.165006 [debug] [ThreadPool]: Creating schema "database: "*****"
schema: "public_silver"
"
[0m21:55:31.170359 [debug] [ThreadPool]: Using postgres connection "create_*****_public_silver"
[0m21:55:31.171132 [debug] [ThreadPool]: On create_*****_public_silver: BEGIN
[0m21:55:31.172280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.175226 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:55:31.176046 [debug] [ThreadPool]: Using postgres connection "create_*****_public_silver"
[0m21:55:31.176749 [debug] [ThreadPool]: On create_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "create_*****_public_silver"} */
create schema if not exists "public_silver"
[0m21:55:31.177684 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:55:31.178920 [debug] [ThreadPool]: On create_*****_public_silver: COMMIT
[0m21:55:31.179686 [debug] [ThreadPool]: Using postgres connection "create_*****_public_silver"
[0m21:55:31.180338 [debug] [ThreadPool]: On create_*****_public_silver: COMMIT
[0m21:55:31.181623 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:55:31.182792 [debug] [ThreadPool]: On create_*****_public_silver: Close
[0m21:55:31.184678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_*****_public_silver, now list_*****_public_bronze)
[0m21:55:31.190623 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m21:55:31.191401 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m21:55:31.192395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.195244 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:55:31.196159 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m21:55:31.196969 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:55:31.199684 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:55:31.201239 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m21:55:31.202568 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m21:55:31.203959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_silver)
[0m21:55:31.206599 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m21:55:31.207670 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m21:55:31.208510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.212499 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:55:31.213395 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m21:55:31.214182 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:55:31.216390 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m21:55:31.217833 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m21:55:31.218718 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m21:55:31.219743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_gold)
[0m21:55:31.222816 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m21:55:31.223978 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m21:55:31.224720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.227502 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:55:31.228225 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m21:55:31.228995 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:55:31.231182 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m21:55:31.233663 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m21:55:31.234703 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m21:55:31.239987 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:31.241318 [debug] [MainThread]: On master: BEGIN
[0m21:55:31.242377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:31.245515 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:55:31.246346 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:31.247132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:31.251852 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:55:31.253603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6e3593-2533-409a-9928-e374cdd1cfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b5eaf4c0>]}
[0m21:55:31.254426 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:31.255180 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:31.255825 [debug] [MainThread]: On master: BEGIN
[0m21:55:31.256590 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:55:31.257305 [debug] [MainThread]: On master: COMMIT
[0m21:55:31.257959 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:31.258571 [debug] [MainThread]: On master: COMMIT
[0m21:55:31.259464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:31.260222 [debug] [MainThread]: On master: Close
[0m21:55:31.261144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:31.262407 [info ] [MainThread]: 
[0m21:55:31.269800 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.cleaned_financial_data
[0m21:55:31.270917 [info ] [Thread-1  ]: 1 of 1 START sql incremental model public_silver.cleaned_financial_data ........ [RUN]
[0m21:55:31.272274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_gold, now model.financial_data_pipeline.cleaned_financial_data)
[0m21:55:31.273318 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.cleaned_financial_data
[0m21:55:31.280518 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.cleaned_financial_data"
[0m21:55:31.284883 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.cleaned_financial_data
[0m21:55:31.337338 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.cleaned_financial_data"
[0m21:55:31.346106 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:55:31.347193 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: BEGIN
[0m21:55:31.347954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:31.350942 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m21:55:31.352115 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:55:31.353140 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.cleaned_financial_data"} */

      
  
    

  create  table "*****"."public_silver"."cleaned_financial_data"
  
  
    as
  
  (
    -- Modelo da camada Silver
with raw_data as (
    select
        *,
        cast(price as numeric(10, 2)) as price_numeric,
        cast(date as date) as transaction_date
    from public.bronze_financial_data
),
cleaned_data as (
    select
        ticker,
        price_numeric as price,
        transaction_date as date
    from raw_data
    where price_numeric > 0  -- Exclui valores de preço inválidos
)

select
    *
from cleaned_data
  );
  
  
[0m21:55:31.356903 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.003 seconds
[0m21:55:31.374429 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m21:55:31.375416 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.cleaned_financial_data"
[0m21:55:31.376154 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: COMMIT
[0m21:55:31.377649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:55:31.379854 [debug] [Thread-1  ]: On model.financial_data_pipeline.cleaned_financial_data: Close
[0m21:55:31.381674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6e3593-2533-409a-9928-e374cdd1cfad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b628a520>]}
[0m21:55:31.382851 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model public_silver.cleaned_financial_data ... [[32mSELECT 23[0m in 0.11s]
[0m21:55:31.384102 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.cleaned_financial_data
[0m21:55:31.385947 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:31.386768 [debug] [MainThread]: On master: BEGIN
[0m21:55:31.387550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:31.390239 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:55:31.391012 [debug] [MainThread]: On master: COMMIT
[0m21:55:31.391823 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:31.392641 [debug] [MainThread]: On master: COMMIT
[0m21:55:31.393642 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:31.394605 [debug] [MainThread]: On master: Close
[0m21:55:31.395593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:31.396381 [debug] [MainThread]: Connection 'model.financial_data_pipeline.cleaned_financial_data' was properly closed.
[0m21:55:31.397254 [info ] [MainThread]: 
[0m21:55:31.398085 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m21:55:31.399141 [debug] [MainThread]: Command end result
[0m21:55:31.436966 [info ] [MainThread]: 
[0m21:55:31.438229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:31.439224 [info ] [MainThread]: 
[0m21:55:31.440309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:55:31.441763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0614151, "process_user_time": 1.877408, "process_kernel_time": 0.069903, "process_mem_max_rss": "270372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:31.443212 [debug] [MainThread]: Command `dbt run` succeeded at 21:55:31.443083 after 1.06 seconds
[0m21:55:31.444355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b8980fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b7f59e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b61eeee0>]}
[0m21:55:31.445437 [debug] [MainThread]: Flushing usage events
[0m21:55:35.404871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c60790d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c4327520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c43274c0>]}


============================== 21:55:35.410812 | 4efa5319-ce51-4741-8508-4c6c2835d659 ==============================
[0m21:55:35.410812 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:55:35.412121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/*****/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/*****/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/*****/dbt --project-dir /usr/local/*****/dbt --select gold', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:55:35.576465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4efa5319-ce51-4741-8508-4c6c2835d659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c56a5fa0>]}
[0m21:55:35.632942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4efa5319-ce51-4741-8508-4c6c2835d659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c4445910>]}
[0m21:55:35.634526 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:55:35.693940 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:55:35.902825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:35.903750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:35.938766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4efa5319-ce51-4741-8508-4c6c2835d659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c355a130>]}
[0m21:55:36.051810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4efa5319-ce51-4741-8508-4c6c2835d659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c5b21df0>]}
[0m21:55:36.053335 [info ] [MainThread]: Found 3 models, 4 sources, 428 macros
[0m21:55:36.054270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4efa5319-ce51-4741-8508-4c6c2835d659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c36bda00>]}
[0m21:55:36.055854 [info ] [MainThread]: 
[0m21:55:36.056936 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:36.058291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_*****'
[0m21:55:36.113289 [debug] [ThreadPool]: Using postgres connection "list_*****"
[0m21:55:36.114232 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m21:55:36.114979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:36.118708 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m21:55:36.120659 [debug] [ThreadPool]: On list_*****: Close
[0m21:55:36.121872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****, now create_*****_public_gold)
[0m21:55:36.123312 [debug] [ThreadPool]: Creating schema "database: "*****"
schema: "public_gold"
"
[0m21:55:36.130634 [debug] [ThreadPool]: Using postgres connection "create_*****_public_gold"
[0m21:55:36.132989 [debug] [ThreadPool]: On create_*****_public_gold: BEGIN
[0m21:55:36.134045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:36.138501 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:55:36.139951 [debug] [ThreadPool]: Using postgres connection "create_*****_public_gold"
[0m21:55:36.140758 [debug] [ThreadPool]: On create_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "create_*****_public_gold"} */
create schema if not exists "public_gold"
[0m21:55:36.141834 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:55:36.143346 [debug] [ThreadPool]: On create_*****_public_gold: COMMIT
[0m21:55:36.144254 [debug] [ThreadPool]: Using postgres connection "create_*****_public_gold"
[0m21:55:36.145305 [debug] [ThreadPool]: On create_*****_public_gold: COMMIT
[0m21:55:36.147225 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:55:36.148016 [debug] [ThreadPool]: On create_*****_public_gold: Close
[0m21:55:36.149871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_*****_public_gold, now list_*****_public_silver)
[0m21:55:36.156520 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m21:55:36.157387 [debug] [ThreadPool]: On list_*****_public_silver: BEGIN
[0m21:55:36.158185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:36.161464 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:55:36.162430 [debug] [ThreadPool]: Using postgres connection "list_*****_public_silver"
[0m21:55:36.163345 [debug] [ThreadPool]: On list_*****_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_silver"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m21:55:36.165616 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m21:55:36.167299 [debug] [ThreadPool]: On list_*****_public_silver: ROLLBACK
[0m21:55:36.168297 [debug] [ThreadPool]: On list_*****_public_silver: Close
[0m21:55:36.169483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_silver, now list_*****_public_bronze)
[0m21:55:36.172260 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m21:55:36.173080 [debug] [ThreadPool]: On list_*****_public_bronze: BEGIN
[0m21:55:36.173829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:36.176437 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:55:36.177260 [debug] [ThreadPool]: Using postgres connection "list_*****_public_bronze"
[0m21:55:36.177998 [debug] [ThreadPool]: On list_*****_public_bronze: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_bronze"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m21:55:36.180098 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m21:55:36.181591 [debug] [ThreadPool]: On list_*****_public_bronze: ROLLBACK
[0m21:55:36.182491 [debug] [ThreadPool]: On list_*****_public_bronze: Close
[0m21:55:36.183658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_*****_public_bronze, now list_*****_public_gold)
[0m21:55:36.186137 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m21:55:36.186809 [debug] [ThreadPool]: On list_*****_public_gold: BEGIN
[0m21:55:36.187487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:36.190195 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:55:36.190933 [debug] [ThreadPool]: Using postgres connection "list_*****_public_gold"
[0m21:55:36.191621 [debug] [ThreadPool]: On list_*****_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "list_*****_public_gold"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      '*****' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m21:55:36.194395 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:55:36.196046 [debug] [ThreadPool]: On list_*****_public_gold: ROLLBACK
[0m21:55:36.196930 [debug] [ThreadPool]: On list_*****_public_gold: Close
[0m21:55:36.202292 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.203381 [debug] [MainThread]: On master: BEGIN
[0m21:55:36.204202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:36.207005 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:55:36.208027 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.208878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:36.213890 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:55:36.215638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4efa5319-ce51-4741-8508-4c6c2835d659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c36bda00>]}
[0m21:55:36.216496 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:36.217342 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.218051 [debug] [MainThread]: On master: BEGIN
[0m21:55:36.219094 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:55:36.219937 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.220800 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.221589 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.222724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:36.223676 [debug] [MainThread]: On master: Close
[0m21:55:36.224613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:36.225486 [info ] [MainThread]: 
[0m21:55:36.231809 [debug] [Thread-1  ]: Began running node model.financial_data_pipeline.aggregated_financial_data
[0m21:55:36.232911 [info ] [Thread-1  ]: 1 of 1 START sql table model public_gold.aggregated_financial_data ............. [RUN]
[0m21:55:36.233968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_*****_public_gold, now model.financial_data_pipeline.aggregated_financial_data)
[0m21:55:36.234777 [debug] [Thread-1  ]: Began compiling node model.financial_data_pipeline.aggregated_financial_data
[0m21:55:36.241906 [debug] [Thread-1  ]: Writing injected SQL for node "model.financial_data_pipeline.aggregated_financial_data"
[0m21:55:36.246915 [debug] [Thread-1  ]: Began executing node model.financial_data_pipeline.aggregated_financial_data
[0m21:55:36.286017 [debug] [Thread-1  ]: Writing runtime sql for node "model.financial_data_pipeline.aggregated_financial_data"
[0m21:55:36.291522 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m21:55:36.292645 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: BEGIN
[0m21:55:36.293511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:36.296357 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m21:55:36.297178 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m21:55:36.298002 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */

  
    

  create  table "*****"."public_gold"."aggregated_financial_data__dbt_tmp"
  
  
    as
  
  (
    -- Modelo da camada Gold
with daily_aggregates as (
    select
        date as transaction_date,
        avg(price) as avg_price,
        min(price) as min_price,
        max(price) as max_price,
        count(ticker) as total_transactions
    from public_silver.cleaned_financial_data
    group by date
)

select
    *
from daily_aggregates
order by transaction_date
  );
  
[0m21:55:36.302077 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.003 seconds
[0m21:55:36.308562 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m21:55:36.309425 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */
alter table "*****"."public_gold"."aggregated_financial_data__dbt_tmp" rename to "aggregated_financial_data"
[0m21:55:36.310360 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:55:36.327041 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: COMMIT
[0m21:55:36.328213 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m21:55:36.329002 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: COMMIT
[0m21:55:36.330392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:55:36.337920 [debug] [Thread-1  ]: Applying DROP to: "*****"."public_gold"."aggregated_financial_data__dbt_backup"
[0m21:55:36.342869 [debug] [Thread-1  ]: Using postgres connection "model.financial_data_pipeline.aggregated_financial_data"
[0m21:55:36.343892 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financial_data", "target_name": "dev", "node_id": "model.financial_data_pipeline.aggregated_financial_data"} */
drop table if exists "*****"."public_gold"."aggregated_financial_data__dbt_backup" cascade
[0m21:55:36.344952 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m21:55:36.347634 [debug] [Thread-1  ]: On model.financial_data_pipeline.aggregated_financial_data: Close
[0m21:55:36.350085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4efa5319-ce51-4741-8508-4c6c2835d659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c5ce58b0>]}
[0m21:55:36.351438 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public_gold.aggregated_financial_data ........ [[32mSELECT 3[0m in 0.11s]
[0m21:55:36.353015 [debug] [Thread-1  ]: Finished running node model.financial_data_pipeline.aggregated_financial_data
[0m21:55:36.354939 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.355722 [debug] [MainThread]: On master: BEGIN
[0m21:55:36.356508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:36.359147 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:55:36.360209 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.361072 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.361729 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.362850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:36.363601 [debug] [MainThread]: On master: Close
[0m21:55:36.364630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:36.365597 [debug] [MainThread]: Connection 'model.financial_data_pipeline.aggregated_financial_data' was properly closed.
[0m21:55:36.366493 [info ] [MainThread]: 
[0m21:55:36.367535 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m21:55:36.368722 [debug] [MainThread]: Command end result
[0m21:55:36.409067 [info ] [MainThread]: 
[0m21:55:36.410063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:36.411168 [info ] [MainThread]: 
[0m21:55:36.412436 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:55:36.414152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0683677, "process_user_time": 1.86782, "process_kernel_time": 0.05993, "process_mem_max_rss": "270372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:36.415269 [debug] [MainThread]: Command `dbt run` succeeded at 21:55:36.415155 after 1.07 seconds
[0m21:55:36.416107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c60790d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c39b2130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41c35078b0>]}
[0m21:55:36.416948 [debug] [MainThread]: Flushing usage events
